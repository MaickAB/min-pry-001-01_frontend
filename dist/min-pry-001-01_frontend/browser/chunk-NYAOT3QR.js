import{a as ye}from"./chunk-VXYGXVWO.js";import{f as st}from"./chunk-R2XLAL2B.js";import{a as gt,b as ht,c as xt}from"./chunk-P5K5KTAJ.js";import{a as vt,b as te}from"./chunk-2RUBCXOU.js";import{b as pt}from"./chunk-GOSJJDVW.js";import"./chunk-MJOHIA6K.js";import{a as me,b as $,d as Z,e as Le,f as Ie,g as ut,h as _t,i as U,j as ee,k as H,l as q,m as z}from"./chunk-ZSPJV2X2.js";import{d as dt,f as Ce,g as Q,h as ct}from"./chunk-64FVGRX5.js";import{c as mt,d as j}from"./chunk-AIZYAHQP.js";import{a as ce,b as A}from"./chunk-AQMLQG24.js";import"./chunk-R25NPE2E.js";import{$ as W,E as O,I as w,N as B,_ as N,a as ae,aa as K,ba as k,t as le,v as se,w as de,x as Se,z as P}from"./chunk-KZFJR7EH.js";import{$ as I,$a as Ee,Aa as Oe,Ab as f,Bb as re,Cb as R,Db as E,Ea as s,Fa as y,Mb as he,Nb as xe,R as oe,Ua as h,W as ne,Wa as c,Za as L,ab as Be,bb as Ne,cb as We,db as n,eb as o,fb as p,ia as rt,ja as u,jb as b,ka as _,kb as g,lb as m,nc as D,pb as Y,qb as X,qc as Me,rb as J,rc as V,sa as F,sb as at,tb as l,ub as T,vb as S,wb as ie,xb as lt,yb as x,zb as v}from"./chunk-VURLBMTQ.js";var Te=(()=>{let d=class d{constructor(t){this.httpClient=t,this.url="http://127.0.0.1:8000/api/registro/comercializacion/compra/lote/"}index(){return this.httpClient.get(this.url+"index")}create(){return this.httpClient.get(this.url+"create")}store(t){return this.httpClient.post(this.url+"store",t)}edit(t){return this.httpClient.get(this.url+"edit/"+t)}show(t){return this.httpClient.get(this.url+"show/"+t)}update(t){return this.httpClient.put(this.url+"update",t)}destroy(t){return this.httpClient.delete(this.url+"destroy/"+t)}getNumLote(t){return this.httpClient.get(this.url+"numLote/"+t)}updateState(t){return this.httpClient.put(this.url+"updateState",t)}};d.\u0275fac=function(e){return new(e||d)(ne(ae))},d.\u0275prov=oe({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();var Pt=()=>({width:"75vw"}),Ot=()=>({transform:"scale(1.5)","margin-top":"10px"});function Bt(a,d){a&1&&(n(0,"small",44),l(1,"Requerido."),o())}function Nt(a,d){a&1&&(n(0,"small",44),l(1,"Requerido."),o())}function Wt(a,d){a&1&&(n(0,"small",44),l(1,"Requerido."),o())}function kt(a,d){a&1&&(n(0,"small",44),l(1,"Requerido."),o())}function At(a,d){a&1&&(n(0,"small",44),l(1,"Requerido."),o())}function zt(a,d){a&1&&(n(0,"small",44),l(1,"Opcional, Tipo Num\xE9rico."),o())}function Ft(a,d){a&1&&(n(0,"small",44),l(1,"Requerido, Tipo Num\xE9rico."),o())}function jt(a,d){if(a&1){let i=b();n(0,"div")(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"label"),l(6,"Regional:"),o()(),n(7,"div",8)(8,"p-dropdown",9),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idRegional,e)||(r.lote.idRegional=e),_(e)}),g("onChange",function(e){u(i);let r=m(2);return _(r.loadSucursales(e.value))}),o(),h(9,Bt,2,0,"small",10),o()(),n(10,"div",6)(11,"div",7)(12,"label"),l(13,"Sucursal:"),o()(),n(14,"div",8)(15,"p-dropdown",11),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idSucursal,e)||(r.lote.idSucursal=e),_(e)}),g("onChange",function(e){u(i);let r=m(2);return _(r.loadNumLote(e.value))}),o(),h(16,Nt,2,0,"small",10),o()()()(),p(17,"hr"),n(18,"div",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"label",16),l(23,"Mineral"),o(),n(24,"p-dropdown",17),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idMineral,e)||(r.lote.idMineral=e),_(e)}),g("onChange",function(e){u(i);let r=m(2);return _(r.loadMineral(e.value))}),o(),h(25,Wt,2,0,"small",10),o(),p(26,"hr"),n(27,"div"),p(28,"img",18),o(),p(29,"hr"),n(30,"div",19)(31,"h2")(32,"b"),l(33),o()()()()(),n(34,"div",20)(35,"div",21)(36,"div",19)(37,"label",22),l(38,"Cooperativas"),o(),n(39,"p-dropdown",23),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idCooperativa,e)||(r.lote.idCooperativa=e),_(e)}),g("onChange",function(e){u(i);let r=m(2);return _(r.loadSocios(e.value))}),o(),h(40,kt,2,0,"small",10),o(),n(41,"div",19)(42,"label",24),l(43,"Socios"),o(),n(44,"p-dropdown",25),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idSocio,e)||(r.lote.idSocio=e),_(e)}),o(),h(45,At,2,0,"small",10),o(),n(46,"div",19)(47,"label",26),l(48,"Moliendero"),o(),n(49,"p-dropdown",27),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.idMoliendero,e)||(r.lote.idMoliendero=e),_(e)}),o()(),n(50,"div",12)(51,"div",28)(52,"label",29),l(53,"N\xFAm. de Sacos"),o(),n(54,"input",30),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.sacos,e)||(r.lote.sacos=e),_(e)}),o(),h(55,zt,2,0,"small",10),o(),n(56,"div",28)(57,"label",31),l(58,"Peso Bruto (Kg)"),o(),n(59,"input",32),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.pesoBruto,e)||(r.lote.pesoBruto=e),_(e)}),g("keyup",function(){u(i);let e=m(2);return _(e.calculateHumedadKg())})("change",function(){u(i);let e=m(2);return _(e.calculateHumedadKg())}),o(),h(60,Ft,2,0,"small",10),o()(),n(61,"div",12)(62,"div",8)(63,"div",19)(64,"label",33),l(65,"Humedad (%): "),o(),n(66,"input",34),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.humedadPorcentaje,e)||(r.humedadPorcentaje=e),_(e)}),g("keyup",function(){u(i);let e=m(2);return _(e.calculateHumedadKg())})("change",function(){u(i);let e=m(2);return _(e.calculateHumedadKg())}),o()()(),n(67,"div",8)(68,"div",19)(69,"label",33),l(70,"Humedad (Kg): "),o(),n(71,"input",34),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.humedad,e)||(r.lote.humedad=e),_(e)}),g("keyup",function(){u(i);let e=m(2);return _(e.calculateHumedadPorcentaje())})("change",function(){u(i);let e=m(2);return _(e.calculateHumedadPorcentaje())}),o()()()(),n(72,"div",35)(73,"div",36)(74,"label",37),l(75,"Tara (Kg): "),o()(),n(76,"div",38)(77,"input",39),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.tara,e)||(r.lote.tara=e),_(e)}),o()(),n(78,"div",40)(79,"p-checkbox",41),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.tara,e)||(r.tara=e),_(e)}),g("onChange",function(){u(i);let e=m(2);return _(e.calculatePesoNeto())}),o()()(),n(80,"div",35)(81,"div",36)(82,"label",42),l(83,"Peso Neto (Kg): "),o()(),n(84,"div",8)(85,"input",43),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.pesoNeto,e)||(r.pesoNeto=e),_(e)}),o()()()()()(),p(86,"hr"),n(87,"div")(88,"p")(89,"b"),l(90,"USUARIO: "),o(),l(91),p(92,"br"),n(93,"b"),l(94,"FECHA: "),o(),l(95),he(96,"date"),n(97,"b"),l(98,"HORA: "),o(),l(99),he(100,"date"),o()()()}if(a&2){let i=m(2);s(8),c("options",i.regionales),x("ngModel",i.lote.idRegional),s(),c("ngIf",!i.valIdRegional()),s(6),c("options",i.sucursales),x("ngModel",i.lote.idSucursal),s(),c("ngIf",!i.valIdSucursal()),s(8),c("options",i.minerales),x("ngModel",i.lote.idMineral),s(),c("ngIf",!i.valIdMineral()),s(3),c("src",i.mineral.foto,Oe),s(5),S("N\xBA Lote: ",i.lote.numLote,""),s(6),c("options",i.cooperativas),x("ngModel",i.lote.idCooperativa),s(),c("ngIf",!i.valIdCooperativa()),s(4),c("options",i.socios),x("ngModel",i.lote.idSocio),s(),c("ngIf",!i.valIdSocio()),s(4),c("options",i.molienderos),x("ngModel",i.lote.idMoliendero),s(5),x("ngModel",i.lote.sacos),s(),c("ngIf",!i.valSacos()),s(4),x("ngModel",i.lote.pesoBruto),s(),c("ngIf",!i.valPesoBruto()),s(6),x("ngModel",i.humedadPorcentaje),s(5),x("ngModel",i.lote.humedad),s(6),x("ngModel",i.lote.tara),c("disabled",!0),s(2),L(E(44,Ot)),x("ngModel",i.tara),c("binary",!0),s(6),x("ngModel",i.pesoNeto),c("disabled",!0),s(6),lt(" ",i.usuario.persona.nombre," ",i.usuario.persona.apePaterno," ",i.usuario.persona.apeMaterno,""),s(4),S(" ",xe(96,38,i.fechaHora,"dd/MM/yyyy")," "),s(4),S(" ",xe(100,41,i.fechaHora,"HH:mm:ss")," ")}}function Ut(a,d){a&1&&(n(0,"div")(1,"div",45),p(2,"p-progressSpinner",46),n(3,"span",47),l(4,"Cargando..."),o()()())}function Ht(a,d){if(a&1&&(p(0,"hr"),h(1,jt,101,45,"div",3)(2,Ut,5,0,"div",3)),a&2){let i=m();s(),c("ngIf",!i.loading),s(),c("ngIf",i.loading)}}function Qt(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Guardando..."),o(),p(3,"span",52),o())}function Kt(a,d){if(a&1){let i=b();n(0,"div",48)(1,"div",49),h(2,Qt,4,0,"div",3),o(),n(3,"div",8)(4,"p-button",50),g("click",function(){u(i);let e=m();return _(e.save())}),o(),n(5,"p-button",51),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)("hidden",i.saving),s(),c("text",!0)("raised",!0)}}var Ye=(()=>{let d=class d{constructor(t,e,r){this.principalService=t,this.messageService=e,this.loteService=r,this.changeLote=new F}showCreate(){this.estado=!0,this.loading=!0,this.saving=!1,console.log("REQUEST->create"),this.loteService.create().subscribe({next:t=>{this.regionales=t.regionales,this.sucursales=[],this.minerales=t.minerales,this.cooperativas=t.cooperativas,this.molienderos=t.molienderos,this.socios=[],this.mineral={nombre:"",abreviatura:"",foto:"/img/mineralDefecto.png"},this.humedadPorcentaje=0,this.tara=!0,this.pesoNeto=0,this.lote={idUsuario:this.principalService.getUsuarioStorage().id,idMoliendero:null,numLote:"",sacos:"",pesoBruto:"",humedad:0,tara:0},this.usuario=this.principalService.getUsuarioStorage(),this.initReloj(),console.log("RESPONSE->create",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->create Error en:",t.error)},complete:()=>{this.loading=!1}})}showEdit(t){this.estado=!0,this.loading=!0,this.saving=!1,console.log("REQUEST->edit",t),this.loteService.edit(t).subscribe({next:e=>{this.regionales=e.regionales,this.loadSucursales(e.lote.idRegional),this.minerales=e.minerales,this.cooperativas=e.cooperativas,this.molienderos=e.molienderos,this.tara=!!e.lote.tara,this.lote=e.lote,this.loadMineral(e.lote.idMineral),this.loadSocios(e.lote.idCooperativa),this.calculateHumedadPorcentaje(),this.usuario=this.principalService.getUsuarioStorage(),this.initReloj(),console.log("RESPONSE->edit",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->edit Error en:",e.error)},complete:()=>{this.loading=!1}})}save(){this.validate()?(this.saving=!0,this.lote.id?(console.log("REQUEST->update",this.lote),this.loteService.update(this.lote).subscribe({next:t=>{this.lote=t.lote,this.changeLote.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->update",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->update Error en:",t.error)}})):(console.log("REQUEST->store",this.lote),this.loteService.store(this.lote).subscribe({next:t=>{this.lote=t.lote,this.changeLote.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->store",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->store Error en:",t.error)}}))):(this.messageService.add({severity:"error",summary:"ERROR",detail:"Datos incorrectos...!!"}),console.log("Datos Incorrectos...!!"))}cancel(){this.estado=!1}loadSucursales(t){let e=this.regionales.find(r=>r.id===t);this.sucursales=e?e.sucursales:[]}loadMineral(t){this.mineral=this.minerales.find(e=>e.id===t)}loadSocios(t){let e=this.cooperativas.find(r=>r.id===t);this.socios=e.socios}loadNumLote(t){console.log("REQUEST->getNumLote",t),this.loteService.getNumLote(t).subscribe({next:e=>{this.lote.numLote=e.numLote,console.log("RESPONSE->getNumLote",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->getNumLote Error en:",e.error)},complete:()=>{this.loading=!1}})}calculateHumedadKg(){this.lote.humedad=Math.round((this.humedadPorcentaje??0)*parseInt(this.lote.pesoBruto)/100),this.calculatePesoNeto()}calculateHumedadPorcentaje(){this.humedadPorcentaje=Math.round(this.lote.humedad*100/parseInt(this.lote.pesoBruto)),this.calculatePesoNeto()}calculatePesoNeto(){this.tara?this.lote.tara=Math.round(parseInt(this.lote.pesoBruto)*.3/46):this.lote.tara=0,this.pesoNeto=parseInt(this.lote.pesoBruto)-(this.lote.tara+this.lote.humedad)}initReloj(){setInterval(()=>{this.fechaHora=new Date},1e3)}valIdRegional(){return!!this.lote.idRegional}valIdSucursal(){return!!this.lote.idSucursal}valIdMineral(){return!!this.lote.idMineral}valIdCooperativa(){return!!this.lote.idCooperativa}valIdSocio(){return!!this.lote.idSocio}valSacos(){return!!/^[\d]{0,20}$/.test(this.lote.sacos||"")}valPesoBruto(){return!!/^[\d]{1,20}$/.test(this.lote.pesoBruto)}validate(){return this.valIdRegional()&&this.valIdSucursal()&&this.valIdMineral()&&this.valIdCooperativa()&&this.valIdSocio()&&this.valSacos()&&this.valPesoBruto()}};d.\u0275fac=function(e){return new(e||d)(y(ct),y(w),y(Te))},d.\u0275cmp=I({type:d,selectors:[["app-dialog-lote"]],outputs:{changeLote:"changeLote"},standalone:!0,features:[R],decls:3,vars:5,consts:[["closeOnEscape","true","closable","true","header","REGISTRO DE COMPRA","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],[4,"ngIf"],[1,"grid","flex","justify-content-center"],[1,"col-10"],[1,"grid","field"],[1,"col-4","text-right","pt-2"],[1,"col-6"],["id","idRegional","optionValue","id","optionLabel","nombre",3,"ngModelChange","onChange","options","ngModel"],["class","p-error",4,"ngIf"],["id","idSucursal","optionValue","id","optionLabel","nombre",3,"ngModelChange","onChange","options","ngModel"],[1,"grid"],[1,"col-12","md:col-4"],[1,"card","shadow-3","text-center",2,"min-height","550px"],[1,"field","text-left"],["for","idMineral"],["id","idMineral","optionValue","id","optionLabel","nombre",3,"ngModelChange","onChange","options","ngModel"],["alt","Vista previa de la imagen",2,"width","100%","height","250px",3,"src"],[1,"field"],[1,"col-12","md:col-8"],[1,"card","shadow-3",2,"min-height","550px"],["for","idCooperativa"],["id","idCooperativa","optionValue","id","optionLabel","nombre",3,"ngModelChange","onChange","options","ngModel"],["for","idSocio"],["id","idSocio","optionValue","id","optionLabel","nombre",3,"ngModelChange","options","ngModel"],["for","idMoliendero"],["id","idMoliendero","optionValue","id","optionLabel","nombre",3,"ngModelChange","options","ngModel"],[1,"col-6","field"],["for","sacos"],["type","number","pInputText","","id","sacos",1,"w-full",3,"ngModelChange","ngModel"],["for","pesoBruto"],["type","number","pInputText","","id","pesoBruto",1,"w-full",3,"ngModelChange","keyup","change","ngModel"],["for","humedad"],["type","number","pInputText","","id","humedad",1,"w-full",3,"ngModelChange","keyup","change","ngModel"],[1,"field","grid"],[1,"col-6","text-right","pt-3"],["for","tara"],[1,"col-4"],["type","number","pInputText","","id","tara",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"col-2","text-center"],[3,"ngModelChange","onChange","ngModel","binary"],["for","pesoNeto"],["type","number","pInputText","","id","pesoNeto",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"p-error"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"],[1,"grid","custom-footer"],[1,"col-6","text-left"],["pRipple","","label","Guardar","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,Ht,3,2,"ng-template",1)(2,Kt,6,6,"ng-template",2),o()),e&2&&(L(E(4,Pt)),x("visible",r.estado),c("modal",!0))},dependencies:[z,q,Q,Ce,B,V,D,Me,te,vt,H,ee,P,le,Se,se,de,W,N,k,K,j,A]});let a=d;return a})();var ze=(()=>{let d=class d{constructor(t){this.httpClient=t,this.url="http://127.0.0.1:8000/api/registro/comercializacion/compra/descuento/"}index(t){return this.httpClient.get(this.url+"index/"+t)}create(){return this.httpClient.get(this.url+"create")}store(t){return this.httpClient.post(this.url+"store",t)}edit(t){return this.httpClient.get(this.url+"edit/"+t)}show(t){return this.httpClient.get(this.url+"show/"+t)}update(t){return this.httpClient.put(this.url+"update",t)}destroy(t){return this.httpClient.delete(this.url+"destroy/"+t)}};d.\u0275fac=function(e){return new(e||d)(ne(ae))},d.\u0275prov=oe({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();function qt(a,d){a&1&&(n(0,"small",14),l(1,"Requerido, Num\xE9rico."),o())}function Gt(a,d){a&1&&(n(0,"small",14),l(1,"Requerido, Alfanum\xE9rico de 1-200."),o())}function Zt(a,d){if(a&1){let i=b();p(0,"hr"),n(1,"div",3)(2,"div",4)(3,"div",5),p(4,"i",6),o(),n(5,"div",7)(6,"div",8)(7,"label",9),l(8,"Monto"),o(),n(9,"input",10),f("ngModelChange",function(e){u(i);let r=m();return v(r.descuento.monto,e)||(r.descuento.monto=e),_(e)}),o(),h(10,qt,2,0,"small",11),o(),n(11,"div",8)(12,"label",12),l(13,"Concepto"),o(),n(14,"textarea",13),f("ngModelChange",function(e){u(i);let r=m();return v(r.descuento.concepto,e)||(r.descuento.concepto=e),_(e)}),o(),h(15,Gt,2,0,"small",11),o()()()()}if(a&2){let i=m();s(9),x("ngModel",i.descuento.monto),s(),c("ngIf",!i.valMonto()),s(4),x("ngModel",i.descuento.concepto),s(),c("ngIf",!i.valConcepto())}}function Yt(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Guardando..."),o(),p(3,"span",21),o())}function Xt(a,d){if(a&1){let i=b();n(0,"div",15)(1,"div",16),h(2,Yt,4,0,"div",17),o(),n(3,"div",18)(4,"p-button",19),g("click",function(){u(i);let e=m();return _(e.save())}),o(),n(5,"p-button",20),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)("hidden",i.saving),s(),c("text",!0)("raised",!0)}}var Xe=(()=>{let d=class d{constructor(t,e){this.messageService=t,this.descuentoService=e,this.changeDescuento=new F}create(t){this.descuento={idLote:t,monto:"",concepto:""},this.estado=!0,this.saving=!1}edit(t){this.descuento=t,this.estado=!0,this.saving=!1}save(){this.validate()?(this.saving=!0,this.descuento.id?(console.log("REQUEST->update",this.descuento),this.descuentoService.update(this.descuento).subscribe({next:t=>{this.descuento=t.descuento,this.changeDescuento.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->update",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->update Error en:",t.error)}})):(console.log("REQUEST->store",this.descuento),this.descuentoService.store(this.descuento).subscribe({next:t=>{this.descuento=t.descuento,this.changeDescuento.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->store",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->store Error en:",t.error)}}))):(this.messageService.add({severity:"error",summary:"ERROR",detail:"Datos incorrectos...!!"}),console.log("Datos Incorrectos...!!"))}cancel(){this.estado=!1}valConcepto(){return!!/^[\w áéíóúüñÁÉÍÓÚÜÑ.-]{1,200}$/.test(this.descuento.concepto)}valMonto(){return!!/^[\d.]{1,10}$/.test(this.descuento.monto)}validate(){return this.descuento?this.valConcepto()&&this.valMonto():"Descuento Vacio.false"}};d.\u0275fac=function(e){return new(e||d)(y(w),y(ze))},d.\u0275cmp=I({type:d,selectors:[["app-dialog-descuento"]],outputs:{changeDescuento:"changeDescuento"},standalone:!0,features:[R],decls:3,vars:3,consts:[["closeOnEscape","true","closable","true","header","REGISTRAR DESCUENTOS","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal","draggable"],["pTemplate","content"],["pTemplate","footer"],[1,"card-body","shadow-3"],[1,"grid"],[1,"col-4","text-center"],[1,"pi","pi-dollar","pt-5",2,"font-size","100px"],[1,"col-8"],[1,"field"],["for","monto"],["type","number","pInputText","","id","monto",1,"w-full",3,"ngModelChange","ngModel"],["class","p-error",4,"ngIf"],["for","concepto"],["pInputTextarea","","id","Concepto","rows","3","cols","20",1,"w-full",3,"ngModelChange","ngModel"],[1,"p-error"],[1,"grid","custom-footer"],[1,"col-6","text-left"],[4,"ngIf"],[1,"col-6"],["pRipple","","label","Guardar","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,Zt,16,4,"ng-template",1)(2,Xt,6,6,"ng-template",2),o()),e&2&&(x("visible",r.estado),c("modal",!0)("draggable",!1))},dependencies:[z,te,B,U,V,D,H,ee,P,le,Se,se,de,W,N,k,K,j,mt,A]});let a=d;return a})();var Jt=()=>({width:"200px"}),$t=()=>({width:"450px"});function ei(a,d){a&1&&(n(0,"tr")(1,"th",14),l(2,"CONCEPTO"),o(),n(3,"th",15),l(4,"PORCENTAJE"),o(),n(5,"th",15),l(6,"MONTO"),o()())}function ti(a,d){if(a&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o()()),a&2){let i=d.$implicit;s(2),T(i.deduccion.concepto),s(2),T(i.deduccion.porcentaje),s(2),T(i.deduccion.porcentaje)}}function ii(a,d){if(a&1&&(n(0,"tr")(1,"td",16)(2,"strong"),l(3,"TOTALES:"),o()(),n(4,"td"),l(5),o()()),a&2){let i=m(2);s(5),T(i.total("monto"))}}function oi(a,d){a&1&&(n(0,"tr")(1,"th",14),l(2,"CONCEPTO"),o(),n(3,"th",17),l(4,"PORCENTAJE"),o(),n(5,"th",17),l(6,"MONTO"),o()())}function ni(a,d){if(a&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td")(6,"b"),l(7),o()()()),a&2){let i=d.$implicit;s(2),T(i.deduccion.concepto),s(2),T(i.deduccion.porcentaje),s(3),T(i.deduccion.porcentaje)}}function ri(a,d){if(a&1&&(n(0,"tr")(1,"td",16)(2,"strong"),l(3,"TOTALES:"),o()(),n(4,"td"),l(5),o()()),a&2){let i=m(2);s(5),T(i.total("monto"))}}function ai(a,d){if(a&1&&(n(0,"div",1)(1,"div",8)(2,"div",9)(3,"h5"),l(4,"Deducciones Generales"),o(),p(5,"hr"),n(6,"p-table",10),h(7,ei,7,0,"ng-template",11)(8,ti,7,3,"ng-template",12)(9,ii,6,1,"ng-template",13),o()()(),n(10,"div",8)(11,"div",9)(12,"h5"),l(13,"Deducciones Cooperativa"),o(),p(14,"hr"),n(15,"p-table",10),h(16,oi,7,0,"ng-template",11)(17,ni,8,3,"ng-template",12)(18,ri,6,1,"ng-template",13),o()()()()),a&2){let i=m();s(6),c("value",i.deducciones),s(9),c("value",i.deducciones)}}function li(a,d){a&1&&(n(0,"tr")(1,"th",19),l(2," FECHA "),p(3,"p-sortIcon",20),o(),n(4,"th",21),l(5," CONCEPTO "),p(6,"p-sortIcon",22),o(),n(7,"th",23),l(8," MONTO "),p(9,"p-sortIcon",24),o(),n(10,"th",25),l(11," OPCIONES "),o()())}function si(a,d){if(a&1){let i=b();n(0,"tr")(1,"td")(2,"span",3),l(3,"FECHA: "),o(),l(4),he(5,"date"),p(6,"br"),n(7,"span",3),l(8,"HORA: "),o(),l(9),he(10,"date"),o(),n(11,"td"),l(12),o(),n(13,"td"),l(14),o(),n(15,"td")(16,"p-button",26),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDetail(e.id))}),o(),n(17,"p-button",27),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showEdit(e))}),o(),n(18,"p-button",28),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDelete(e.id))}),o()()()}if(a&2){let i=d.$implicit;s(4),S("",xe(5,10,i.fechaHora,"dd/MM/yyyy")," "),s(5),S("",xe(10,13,i.fechaHora,"HH:mm:ss")," "),s(3),T(i.concepto),s(2),T(i.monto),s(2),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0)}}function di(a,d){if(a&1&&(n(0,"tr")(1,"td",16)(2,"strong"),l(3,"TOTALES:"),o()(),n(4,"td"),l(5),o(),p(6,"td"),o()),a&2){let i=m(2);s(5),T(i.total("monto"))}}function ci(a,d){if(a&1&&(n(0,"div")(1,"p-table",18),h(2,li,12,0,"ng-template",11)(3,si,19,16,"ng-template",12)(4,di,7,1,"ng-template",13),o()()),a&2){let i=m();s(),c("value",i.descuentos)("rowHover",!0)}}function mi(a,d){a&1&&(n(0,"div")(1,"div",29),p(2,"p-progressSpinner",30),n(3,"span",31),l(4,"Cargando..."),o()()())}var St=(()=>{let d=class d{constructor(t,e,r){this.messageService=t,this.descuentoService=e,this.confirmationService=r,this.changeDescuento=new F}show(){this.estado=!0,this.loading=!0,console.log("REQUEST->index"),this.descuentoService.index(this.lote.id).subscribe({next:t=>{this.deducciones=t.deducciones,this.descuentos=t.descuentos,console.log("RESPONSE->index",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->index Error en:",t.error)},complete:()=>{this.loading=!1}})}showCreate(){this.dialog.create(this.lote.id)}showDetail(t){alert("DETALLE DESCUENTO "+t)}showEdit(t){this.dialog.edit(t)}showDelete(t){this.confirmationService.confirm({message:"Est\xE1 seguro de eliminar el Registro...?",header:"Confirmar",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("REQUEST->destroy",t),this.descuentoService.destroy(t).subscribe({next:e=>{this.descuentos=this.descuentos.filter(r=>r.id!==t),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:e.msg,life:3e3}),console.log("RESPONSE->destroy",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->destroy Error en:",e.error)}})}})}report(){alert("REPORTE COMPLETO")}total(t){return this.descuentos.reduce((e,r)=>e+(r[t]||0),0).toFixed(2)}};d.\u0275fac=function(e){return new(e||d)(y(w),y(ze),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-index-descuento"]],viewQuery:function(e,r){if(e&1&&Y(Xe,5),e&2){let C;X(C=J())&&(r.dialog=C.first)}},inputs:{lote:"lote",descuentos:"descuentos",deducciones:"deducciones"},outputs:{changeDescuento:"changeDescuento"},standalone:!0,features:[re([w,O]),R],decls:14,vars:12,consts:[["class","grid",4,"ngIf"],[1,"grid"],[1,"col-6"],[1,"prefijoRow"],[1,"col-6","text-right"],["pRipple","","severity","primary","label","Agregar Descuento","icon","pi pi-plus",3,"click","outlined","raised","text"],[4,"ngIf"],[3,"changeDescuento"],[1,"col-12","sm:col-6"],[1,"card"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[2,"width","50%"],[2,"width","20%"],["colspan","2",1,"text-right"],[2,"width","10%"],["dataKey","id",3,"value","rowHover"],["pSortableColumn","fechaHora",2,"width","25%"],["field","fechaHora"],["pSortableColumn","concepto",2,"width","30%"],["field","concepto"],["pSortableColumn","monto",2,"width","20%"],["field","monto"],["pSortableColumn","monto",2,"width","25%"],["pRipple","","icon","pi pi-eye","severity","info",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"]],template:function(e,r){e&1&&(h(0,ai,19,2,"div",0),n(1,"div",1)(2,"div",2)(3,"h3")(4,"span",3),l(5,"Otros Descuentos"),o()()(),n(6,"div",4)(7,"p-button",5),g("click",function(){return r.showCreate()}),o()()(),p(8,"hr"),h(9,ci,5,2,"div",6)(10,mi,5,0,"div",6),n(11,"app-dialog-descuento",7),g("changeDescuento",function(){return r.show()}),o(),p(12,"p-confirmDialog")(13,"p-toast")),e&2&&(c("ngIf",!1),s(7),L(E(10,Jt)),c("outlined",!0)("raised",!0)("text",!0),s(2),c("ngIf",!r.loading),s(),c("ngIf",r.loading),s(2),L(E(11,$t)))},dependencies:[U,Z,B,Le,Ie,z,q,$,me,N,V,D,Me,H,P,Q,ye,W,k,j,A,ce,Xe]});let a=d;return a})();var Ue=(()=>{let d=class d{constructor(t){this.httpClient=t,this.url="http://127.0.0.1:8000/api/registro/comercializacion/compra/ley/"}index(t){return this.httpClient.get(this.url+"index/"+t)}create(){return this.httpClient.get(this.url+"create")}store(t){return this.httpClient.post(this.url+"store",t)}edit(t){return this.httpClient.get(this.url+"edit/"+t)}show(t){return this.httpClient.get(this.url+"show/"+t)}update(t){return this.httpClient.put(this.url+"update",t)}destroy(t){return this.httpClient.delete(this.url+"destroy/"+t)}};d.\u0275fac=function(e){return new(e||d)(ne(ae))},d.\u0275prov=oe({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();function pi(a,d){a&1&&(n(0,"small",18),l(1,"Requerido."),o())}function ui(a,d){a&1&&(n(0,"small",18),l(1,"Requerido."),o())}function _i(a,d){a&1&&(n(0,"tr")(1,"th",19),l(2,"MINERAL"),o(),n(3,"th",20),l(4,"LEY"),o(),n(5,"th",21),l(6,"U-MEDIDA"),o()())}function gi(a,d){if(a&1){let i=b();n(0,"tr")(1,"td"),l(2),n(3,"input",22),f("ngModelChange",function(e){let r=u(i).$implicit;return v(r.idMineral,e)||(r.idMineral=e),_(e)}),o()(),n(4,"td")(5,"input",23),f("ngModelChange",function(e){let r=u(i).$implicit;return v(r.valor,e)||(r.valor=e),_(e)}),o()(),n(6,"td")(7,"p-dropdown",24),f("ngModelChange",function(e){let r=u(i).$implicit;return v(r.idUnidadMedidaLey,e)||(r.idUnidadMedidaLey=e),_(e)}),o()()()}if(a&2){let i=d.$implicit,t=m(3);s(2),ie(" ",i.nombre,"\xA0(",i.abreviatura,") "),s(),x("ngModel",i.idMineral),s(2),x("ngModel",i.valor),s(2),c("options",t.unidadMedidaLeys),x("ngModel",i.idUnidadMedidaLey),c("appendTo","body")}}function hi(a,d){if(a&1){let i=b();n(0,"div")(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"label",9),l(7,"Solicitante:"),o()(),n(8,"div",6)(9,"p-dropdown",10),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.ley.idSolicitante,e)||(r.ley.idSolicitante=e),_(e)}),o(),h(10,pi,2,0,"small",11),o()()(),n(11,"div",6)(12,"div",7)(13,"div",8)(14,"label",12),l(15,"Laboratorio:"),o()(),n(16,"div",6)(17,"p-dropdown",13),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.ley.idLaboratorio,e)||(r.ley.idLaboratorio=e),_(e)}),o(),h(18,ui,2,0,"small",11),o()()()(),p(19,"hr"),n(20,"div",14)(21,"p-table",15),h(22,_i,7,0,"ng-template",16)(23,gi,8,7,"ng-template",17),o()()()()}if(a&2){let i=m(2);s(9),c("options",i.solicitantes),x("ngModel",i.ley.idSolicitante),s(),c("ngIf",!i.valIdSolicitante()),s(7),c("options",i.laboratorios),x("ngModel",i.ley.idLaboratorio),s(),c("ngIf",!i.valIdLaboratorio()),s(3),c("value",i.leyDetalles)}}function xi(a,d){a&1&&(n(0,"div")(1,"div",25),p(2,"p-progressSpinner",26),n(3,"span",27),l(4,"Cargando..."),o()()())}function vi(a,d){if(a&1&&(p(0,"hr"),h(1,hi,24,7,"div",3)(2,xi,5,0,"div",3)),a&2){let i=m();s(),c("ngIf",!i.loading),s(),c("ngIf",i.loading)}}function fi(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Guardando..."),o(),p(3,"span",33),o())}function Si(a,d){if(a&1){let i=b();n(0,"div",28)(1,"div",29),h(2,fi,4,0,"div",3),o(),n(3,"div",30)(4,"p-button",31),g("click",function(){u(i);let e=m();return _(e.save())}),o(),n(5,"p-button",32),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)("hidden",i.saving),s(),c("text",!0)("raised",!0)}}var Je=(()=>{let d=class d{constructor(t,e){this.messageService=t,this.leyService=e,this.changeLey=new F}create(t){this.estado=!0,this.loading=!0,this.saving=!1,console.log("REQUEST->create"),this.leyService.create().subscribe({next:e=>{this.solicitantes=e.solicitantes,this.laboratorios=e.laboratorios,this.unidadMedidaLeys=e.unidadMedidaLeys,this.ley={idLote:t.id,detalles:[]},t.mineral.minerales.length?this.leyDetalles=t.mineral.minerales.map(r=>({nombre:r.mineral.nombre,abreviatura:r.mineral.abreviatura,idMineral:r.mineral.id,valor:null,idUnidadMedidaLey:null})):this.leyDetalles=[{nombre:t.mineral.nombre,abreviatura:t.mineral.abreviatura,idMineral:t.mineral.id,valor:null,idUnidadMedidaLey:null}],console.log("RESPONSE->create",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->create Error en:",e.error)},complete:()=>{this.loading=!1}})}edit(t){this.estado=!0,this.loading=!0,this.saving=!1,console.log("REQUEST->edit",t.id),this.leyService.edit(t.id).subscribe({next:e=>{this.solicitantes=e.solicitantes,this.laboratorios=e.laboratorios,this.unidadMedidaLeys=e.unidadMedidaLeys,this.ley=t,this.updateLeyDetalles(t.detalles),console.log("RESPONSE->edit",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->edit Error en:",e.error)},complete:()=>{this.loading=!1}})}save(){this.prepareData(),this.validate()?(this.saving=!0,this.ley.id?(console.log("REQUEST->update",this.ley),this.leyService.update(this.ley).subscribe({next:t=>{this.ley=t.ley,this.changeLey.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->update",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->update Error en:",t.error)}})):(console.log("REQUEST->store",this.ley),this.leyService.store(this.ley).subscribe({next:t=>{this.ley=t.ley,this.changeLey.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->store",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->store Error en:",t.error)}}))):(this.messageService.add({severity:"error",summary:"ERROR",detail:"Datos incorrectos...!!"}),console.log("Datos Incorrectos...!!"))}cancel(){this.estado=!1}prepareData(){this.ley.detalles=this.leyDetalles.map(t=>({idMineral:t.idMineral,idUnidadMedidaLey:t.idUnidadMedidaLey,valor:t.valor}))}updateLeyDetalles(t){this.leyDetalles=[],t.forEach(e=>{this.leyDetalles.push({nombre:e.mineral.nombre,abreviatura:e.mineral.abreviatura,idMineral:e.idMineral,valor:e.valor,idUnidadMedidaLey:e.idUnidadMedidaLey})})}valIdSolicitante(){return!!this.ley.idSolicitante}valIdLaboratorio(){return!!this.ley.idLaboratorio}validate(){return this.ley?this.valIdSolicitante()&&this.valIdLaboratorio():"Ley Vacio.false"}};d.\u0275fac=function(e){return new(e||d)(y(w),y(Ue))},d.\u0275cmp=I({type:d,selectors:[["app-dialog-ley"]],outputs:{changeLey:"changeLey"},standalone:!0,features:[R],decls:3,vars:2,consts:[["closeOnEscape","true","closable","true","header","REGISTRO DE LEY","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],[4,"ngIf"],[1,"card","pb-3"],[1,"grid","flex","justify-content-center"],[1,"col-8"],[1,"grid","field"],[1,"col-4","text-right","pt-2"],["for","idSolicitante"],["id","idSolicitante","optionValue","id","optionLabel","nombre",3,"ngModelChange","options","ngModel"],["class","p-error",4,"ngIf"],["for","idLaboratorio"],["id","idLaboratorio","optionValue","id","optionLabel","nombre",3,"ngModelChange","options","ngModel"],[1,"card","shadow-3"],["dataKey","id",3,"value"],["pTemplate","header"],["pTemplate","body"],[1,"p-error"],[2,"width","50%"],[2,"width","30%"],[2,"width","20%"],["type","hidden","pInputText","",3,"ngModelChange","ngModel"],["type","text","pInputText","",1,"w-full",3,"ngModelChange","ngModel"],["id","idUnidadMedidaLey","optionValue","id","optionLabel","abreviatura",3,"ngModelChange","options","ngModel","appendTo"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"],[1,"grid","custom-footer"],[1,"col-6","text-left"],[1,"col-6"],["pRipple","","label","Guardar","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,vi,3,2,"ng-template",1)(2,Si,6,6,"ng-template",2),o()),e&2&&(x("visible",r.estado),c("modal",!0))},dependencies:[z,q,te,B,U,Z,V,D,H,ee,P,le,se,de,Q,Ce,W,N,k,K,j,A]});let a=d;return a})();var Ci=()=>({width:"200px"}),yi=()=>({width:"450px"});function Ei(a,d){a&1&&(n(0,"tr")(1,"th",12),l(2," SOLICITANTE "),o(),n(3,"th",12),l(4," LABORATORIO "),o(),n(5,"th",13),l(6," LEYES "),o(),n(7,"th",12),l(8," OPCIONES "),o()())}function bi(a,d){if(a&1&&(n(0,"h3"),l(1),o()),a&2){let i=m().$implicit;s(),T(i.solicitante.nombre)}}function wi(a,d){if(a&1&&l(0),a&2){let i=m().$implicit;S(" ",i.solicitante.nombre," ")}}function Mi(a,d){if(a&1&&(n(0,"span",3),l(1),o(),l(2)),a&2){let i=d.$implicit;s(),S("",(i.mineral==null?null:i.mineral.abreviatura)||""," : "),s(),ie(" ",i.valor,"\xA0",(i.unidad_medida_ley==null?null:i.unidad_medida_ley.abreviatura)||""," \xA0\xA0\xA0 ")}}function Li(a,d){if(a&1){let i=b();n(0,"tr")(1,"td"),h(2,bi,2,1,"h3")(3,wi,1,1),o(),n(4,"td"),l(5),o(),n(6,"td"),Ne(7,Mi,3,3,null,null,Be),o(),n(9,"td")(10,"p-button",14),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showEdit(e))}),o(),n(11,"p-button",15),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDelete(e.id))}),o()()()}if(a&2){let i=d.$implicit;s(2),Ee(i.solicitante.nombre=="TRANSE"?2:3),s(3),T(i.laboratorio.nombre),s(2),We(i.detalles),s(3),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0)}}function Ii(a,d){}function Ti(a,d){if(a&1&&(n(0,"div")(1,"p-table",8,0),h(3,Ei,9,0,"ng-template",9)(4,Li,12,6,"ng-template",10)(5,Ii,0,0,"ng-template",11),o()()),a&2){let i=m();s(),c("value",i.leyes)("rowHover",!0)}}function Ri(a,d){a&1&&(n(0,"div")(1,"div",16),p(2,"p-progressSpinner",17),n(3,"span",18),l(4,"Cargando..."),o()()())}var yt=(()=>{let d=class d{constructor(t,e,r){this.messageService=t,this.leyService=e,this.confirmationService=r,this.changeLeyes=new F,this.changeDescuento=new F}show(){this.estado=!0,this.loading=!0,console.log("REQUEST->index"),this.leyService.index(this.lote.id).subscribe({next:t=>{this.leyes=t.leyes,this.changeLeyes.emit(t.leyes),console.log("RESPONSE->index",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->index Error en:",t.error)},complete:()=>{this.loading=!1}})}showDetail(t){alert("DETALLE LEY "+t)}showCreate(){this.dialog.create(this.lote)}showEdit(t){this.dialog.edit(t)}showDelete(t){this.confirmationService.confirm({message:"Est\xE1 seguro de eliminar el Registro...?",header:"Confirmar",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("REQUEST->destroy",t),this.leyService.destroy(t).subscribe({next:e=>{this.leyes=this.leyes.filter(r=>r.id!==t),this.changeLeyes.emit(e.leyes),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:e.msg,life:3e3}),console.log("RESPONSE->destroy",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->destroy Error en:",e.error)}})}})}report(){}};d.\u0275fac=function(e){return new(e||d)(y(w),y(Ue),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-index-ley"]],viewQuery:function(e,r){if(e&1&&Y(Je,5),e&2){let C;X(C=J())&&(r.dialog=C.first)}},inputs:{lote:"lote",leyes:"leyes"},outputs:{changeLeyes:"changeLeyes",changeDescuento:"changeDescuento"},standalone:!0,features:[re([w,O]),R],decls:13,vars:11,consts:[["dt",""],[1,"grid"],[1,"col-6"],[1,"prefijoRow"],[1,"col-6","text-right"],["pRipple","","severity","primary","label","Agregar Ley","icon","pi pi-plus",3,"click","outlined","raised","text"],[4,"ngIf"],[3,"changeLey"],["dataKey","id",3,"value","rowHover"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[2,"width","20%"],[2,"width","40%"],["pRipple","","icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"]],template:function(e,r){e&1&&(n(0,"div",1)(1,"div",2)(2,"h3")(3,"span",3),l(4,"Leyes de Laboratorio"),o()()(),n(5,"div",4)(6,"p-button",5),g("click",function(){return r.showCreate()}),o()()(),p(7,"hr"),h(8,Ti,6,2,"div",6)(9,Ri,5,0,"div",6),n(10,"app-dialog-ley",7),g("changeLey",function(){return r.show()}),o(),p(11,"p-confirmDialog")(12,"p-toast")),e&2&&(s(6),L(E(9,Ci)),c("outlined",!0)("raised",!0)("text",!0),s(2),c("ngIf",!r.loading),s(),c("ngIf",r.loading),s(2),L(E(10,yi)))},dependencies:[U,Z,B,z,q,V,D,$,me,N,H,P,Q,ye,W,k,j,A,ce,Je]});let a=d;return a})();var He=(()=>{let d=class d{constructor(t){this.httpClient=t,this.url="http://127.0.0.1:8000/api/registro/comercializacion/compra/subLote/"}index(t){return this.httpClient.get(this.url+"index/"+t)}create(){return this.httpClient.get(this.url+"create")}store(t){return this.httpClient.post(this.url+"store",t)}edit(t){return this.httpClient.get(this.url+"edit/"+t)}update(t){return this.httpClient.put(this.url+"update",t)}destroy(t){return this.httpClient.delete(this.url+"destroy/"+t)}};d.\u0275fac=function(e){return new(e||d)(ne(ae))},d.\u0275prov=oe({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();function Di(a,d){a&1&&(n(0,"small",26),l(1,"Requerido."),o())}function Vi(a,d){a&1&&(n(0,"small",26),l(1,"Requerido."),o())}function Pi(a,d){if(a&1){let i=b();p(0,"hr"),n(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"label",7),l(6,"Socio :"),o()(),n(7,"div",4)(8,"p-dropdown",8),f("ngModelChange",function(e){u(i);let r=m();return v(r.subLote.idSocio,e)||(r.subLote.idSocio=e),_(e)}),o(),h(9,Di,2,0,"small",9),o()(),n(10,"div",5)(11,"div",6)(12,"label",7),l(13,"Porcentaje (%) :"),o()(),n(14,"div",4)(15,"input",10),f("ngModelChange",function(e){u(i);let r=m();return v(r.subLote.porcentaje,e)||(r.subLote.porcentaje=e),_(e)}),g("keyup",function(){u(i);let e=m();return _(e.calcularAuxSubLote())})("change",function(){u(i);let e=m();return _(e.calcularAuxSubLote())}),o(),h(16,Vi,2,0,"small",9),o()()()(),n(17,"div",11)(18,"div",12)(19,"div",13)(20,"div",14)(21,"h5"),l(22,"Mineral"),o(),p(23,"hr"),n(24,"div",5)(25,"div",15)(26,"label",16),l(27,"Peso Bruto (Kg) : "),o()(),n(28,"div",17)(29,"input",18),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.pesoBruto,e)||(r.auxSubLote.pesoBruto=e),_(e)}),o()()(),n(30,"div",5)(31,"div",15)(32,"label",19),l(33,"Tara (Kg) : "),o()(),n(34,"div",17)(35,"input",20),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.tara,e)||(r.auxSubLote.tara=e),_(e)}),o()()(),n(36,"div",5)(37,"div",21)(38,"label",22),l(39,"Humedad (Kg) : "),o()(),n(40,"div",17)(41,"input",23),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.humedad,e)||(r.auxSubLote.humedad=e),_(e)}),o()()(),n(42,"div",5)(43,"div",15)(44,"label",24),l(45,"Peso Neto (Kg) : "),o()(),n(46,"div",17),p(47,"input",25),o()()()(),n(48,"div",13)(49,"div",14)(50,"h5"),l(51,"Precios"),o(),p(52,"hr"),n(53,"div",5)(54,"div",15)(55,"label",16),l(56,"Precio ($us) : "),o()(),n(57,"div",17)(58,"input",18),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.costoMineralSus,e)||(r.auxSubLote.costoMineralSus=e),_(e)}),o()()(),n(59,"div",5)(60,"div",15)(61,"label",19),l(62,"Regalias ($us) : "),o()(),n(63,"div",17)(64,"input",20),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.costoRegaliaSus,e)||(r.auxSubLote.costoRegaliaSus=e),_(e)}),o()()(),n(65,"div",5)(66,"div",15)(67,"label",16),l(68,"Precio (Bs) : "),o()(),n(69,"div",17)(70,"input",18),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.costoMineralBs,e)||(r.auxSubLote.costoMineralBs=e),_(e)}),o()()(),n(71,"div",5)(72,"div",15)(73,"label",19),l(74,"Regalias (Bs) : "),o()(),n(75,"div",17)(76,"input",20),f("ngModelChange",function(e){u(i);let r=m();return v(r.auxSubLote.costoRegaliaBs,e)||(r.auxSubLote.costoRegaliaBs=e),_(e)}),o()()()()()()()}if(a&2){let i=m();s(8),c("options",i.lote.cooperativa.socios),x("ngModel",i.subLote.idSocio),s(),c("ngIf",!i.valIdSocio()),s(6),x("ngModel",i.subLote.porcentaje),s(),c("ngIf",!i.valPorcentaje()),s(13),x("ngModel",i.auxSubLote.pesoBruto),c("disabled",!0),s(6),x("ngModel",i.auxSubLote.tara),c("disabled",!0),s(6),x("ngModel",i.auxSubLote.humedad),c("disabled",!0),s(6),c("value",i.auxSubLote.pesoNeto)("disabled",!0),s(11),x("ngModel",i.auxSubLote.costoMineralSus),c("disabled",!0),s(6),x("ngModel",i.auxSubLote.costoRegaliaSus),c("disabled",!0),s(6),x("ngModel",i.auxSubLote.costoMineralBs),c("disabled",!0),s(6),x("ngModel",i.auxSubLote.costoRegaliaBs),c("disabled",!0)}}function Oi(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Guardando..."),o(),p(3,"span",32),o())}function Bi(a,d){if(a&1){let i=b();n(0,"div",27)(1,"div",28),h(2,Oi,4,0,"div",29),o(),n(3,"div",17)(4,"p-button",30),g("click",function(){u(i);let e=m();return _(e.save())}),o(),n(5,"p-button",31),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)("hidden",i.saving),s(),c("text",!0)("raised",!0)}}var $e=(()=>{let d=class d{constructor(t,e){this.messageService=t,this.subLoteService=e,this.changeSubLote=new F}create(t,e){this.lote=t,this.subLote={idLote:t.id,idSocio:0,porcentaje:null},this.costo=e,this.auxSubLote={pesoBruto:0,tara:0,humedad:0,pesoNeto:0,costoMineralSus:0,costoMineralBs:0,costoRegaliaSus:0,costoRegaliaBs:0,totalDescuentos:0,totalLiquidacion:0},this.estado=!0,this.saving=!1}edit(t,e,r){this.lote=t,this.subLote=e,this.costo=r,this.calcularAuxSubLote(),this.estado=!0,this.saving=!1}save(){this.validate()?(this.saving=!0,this.subLote.id?(console.log("REQUEST->update",this.subLote),this.subLoteService.update(this.subLote).subscribe({next:t=>{this.subLote=t.subLote,this.changeSubLote.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->update",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->update Error en:",t.error)}})):(console.log("REQUEST->store",this.subLote),this.subLoteService.store(this.subLote).subscribe({next:t=>{this.subLote=t.subLote,this.changeSubLote.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->store",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->store Error en:",t.error)}}))):(this.messageService.add({severity:"error",summary:"ERROR",detail:"Datos incorrectos...!!"}),console.log("Datos Incorrectos...!!"))}cancel(){this.estado=!1}calcularAuxSubLote(){let t=e=>parseFloat(e.toFixed(2));this.auxSubLote={pesoBruto:t(this.lote.pesoBruto*(this.subLote.porcentaje/100)),tara:t(this.lote.tara*(this.subLote.porcentaje/100)),humedad:t(this.lote.humedad*(this.subLote.porcentaje/100)),pesoNeto:t((this.lote.pesoBruto-this.lote.humedad-this.lote.tara)*(this.subLote.porcentaje/100)),costoMineralSus:t(this.costo.mineralSus*(this.subLote.porcentaje/100)),costoMineralBs:t(this.costo.mineralBs*(this.subLote.porcentaje/100)),costoRegaliaSus:t(this.costo.regaliaSus*(this.subLote.porcentaje/100)),costoRegaliaBs:t(this.costo.regaliaBs*(this.subLote.porcentaje/100)),totalDescuentos:0,totalLiquidacion:0}}valIdSocio(){return!!this.subLote.idSocio}valPorcentaje(){return!!/^[\d.]{1,3}$/.test(this.subLote.porcentaje)}validate(){return this.subLote?this.valIdSocio()&&this.valPorcentaje():"SubLote Vacio.false"}};d.\u0275fac=function(e){return new(e||d)(y(w),y(He))},d.\u0275cmp=I({type:d,selectors:[["app-dialog-subLote"]],outputs:{changeSubLote:"changeSubLote"},standalone:!0,features:[R],decls:3,vars:3,consts:[["closeOnEscape","true","closable","true","header","REGISTRAR DESCUENTOS","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal","draggable"],["pTemplate","content"],["pTemplate","footer"],[1,"grid","flex","justify-content-center"],[1,"col-8"],[1,"field","grid"],[1,"col-4","text-right"],[1,"mb-2","md:mb-0"],["id","socio","optionValue","id","optionLabel","nombre",3,"ngModelChange","options","ngModel"],["class","p-error",4,"ngIf"],["pInputText","","type","number",3,"ngModelChange","keyup","change","ngModel"],[1,"card-body","shadow-3"],[1,"grid"],[1,"col-12","sm:col-6"],[1,"card"],[1,"col-6","text-right","pt-3"],["for","pesoBruto"],[1,"col-6"],["type","number","pInputText","","id","pesoBruto",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","tara"],["type","number","pInputText","","id","tara",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"col-6","text-right","pt-2"],["for","humedad"],["type","number","pInputText","","id","humedad",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","pesoNeto"],["type","number","pInputText","","id","pesoBruto",1,"w-full",3,"value","disabled"],[1,"p-error"],[1,"grid","custom-footer"],[1,"col-6","text-left"],[4,"ngIf"],["pRipple","","label","Guardar","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,Pi,77,21,"ng-template",1)(2,Bi,6,6,"ng-template",2),o()),e&2&&(x("visible",r.estado),c("modal",!0)("draggable",!1))},dependencies:[z,te,B,U,V,D,H,ee,Q,Ce,P,le,Se,se,de,W,N,k,K,j,A]});let a=d;return a})();var Ni=()=>({width:"450px"}),Wi=()=>({width:"200px"});function ki(a,d){a&1&&(n(0,"tr")(1,"th",10),l(2," SOCIO "),p(3,"p-sortIcon",11),o(),n(4,"th",12),l(5," DETALLE "),p(6,"p-sortIcon",13),o(),n(7,"th",14),l(8," OPCIONES "),o()())}function Ai(a,d){if(a&1){let i=b();n(0,"tr")(1,"td"),l(2),n(3,"h3"),l(4),o()(),n(5,"td")(6,"div",2)(7,"div",15)(8,"span",4),l(9,"Peso Bruto: "),o(),p(10,"br"),n(11,"span",4),l(12,"Peso Neto: "),o(),p(13,"br"),n(14,"span",4),l(15,"Tara: "),o(),p(16,"br"),n(17,"span",4),l(18,"Humedad: "),o()(),n(19,"div",16),l(20),p(21,"br"),l(22),p(23,"br"),l(24),p(25,"br"),l(26),o()(),p(27,"hr"),n(28,"div",2)(29,"div",15)(30,"span",4),l(31,"Bruto: "),o()(),n(32,"div",16),l(33),o(),n(34,"div",16),l(35),o()(),n(36,"div",2)(37,"div",15)(38,"span",4),l(39,"Regalia: "),o()(),n(40,"div",16),l(41),o(),n(42,"div",16),l(43),o()(),n(44,"div",2)(45,"div",15)(46,"span",4),l(47,"Neto: "),o()(),n(48,"div",16),l(49),o(),n(50,"div",16),l(51),o()()(),n(52,"td")(53,"p-button",17),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDetail(e.id))}),o(),n(54,"p-button",18),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showEdit(e))}),o(),n(55,"p-button",19),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDelete(e.id))}),o()()()}if(a&2){let i=d.$implicit;s(2),S(" ",i.socio," "),s(2),S("",i.porcentaje,"\xA0%"),s(16),S(" ",i.pesoBruto," Kg."),s(2),S(" ",i.pesoNeto," kg. "),s(2),S(" ",i.tara," Kg."),s(2),S(" ",i.humedad," Kg. "),s(7),S(" ",i.mineralSus," $us "),s(2),S(" ",i.mineralBs," Bs. "),s(6),S(" ",i.regaliaSus," $us "),s(2),S(" ",i.regaliaBs," Bs. "),s(6),S(" ",i.netoSus," $us "),s(2),S(" ",i.netoBs," Bs. "),s(2),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0)}}function zi(a,d){if(a&1){let i=b();n(0,"div")(1,"div",2)(2,"div",3)(3,"h3")(4,"span",4),l(5,"Liquidaciones"),o()()(),n(6,"div",5)(7,"p-button",6),g("click",function(){u(i);let e=m();return _(e.showCreate())}),o()()(),p(8,"hr"),n(9,"p-table",7),h(10,ki,9,0,"ng-template",8)(11,Ai,56,18,"ng-template",9),o()()}if(a&2){let i=m();s(7),L(E(7,Wi)),c("outlined",!0)("raised",!0)("text",!0),s(2),c("value",i.auxSubLotes)("rowHover",!0)}}function Fi(a,d){a&1&&(n(0,"div")(1,"div",20),p(2,"p-progressSpinner",21),n(3,"span",22),l(4,"Cargando..."),o()()())}var et=(()=>{let d=class d{constructor(t,e,r){this.messageService=t,this.subLoteService=e,this.confirmationService=r,this.changeSubLote=new F}ngOnInit(){this.loadAuxSubLotes()}show(){this.estado=!0,this.loading=!0,console.log("REQUEST->index",this.lote.id),this.subLoteService.index(this.lote.id).subscribe({next:t=>{this.subLotes=t.subLotes,this.loadAuxSubLotes(),this.changeSubLote.emit(t.subLotes),console.log("RESPONSE->index",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->index Error en:",t.error)},complete:()=>{this.loading=!1}})}showCreate(){this.dialog.create(this.lote,this.costo)}showDetail(t){alert("DETALLE DESCUENTO "+t)}showEdit(t){this.dialog.edit(this.lote,t,this.costo)}showDelete(t){this.confirmationService.confirm({message:"Est\xE1 seguro de eliminar el Registro...?",header:"Confirmar",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("REQUEST->destroy",t),this.subLoteService.destroy(t).subscribe({next:e=>{this.auxSubLotes=this.auxSubLotes.filter(r=>r.id!==t),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:e.msg,life:3e3}),console.log("RESPONSE->destroy",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->destroy Error en:",e.error)}})}})}loadAuxSubLotes(){let t=[],e=r=>parseFloat(r.toFixed(2));this.subLotes.forEach(r=>{t.push({id:r.id,idLote:r.idLote,idSocio:r.idSocio,porcentaje:r.porcentaje,socio:r.socio.nombre,pesoBruto:e(parseFloat(r.lote.pesoBruto)*(r.porcentaje/100)),tara:e(r.lote.tara*(r.porcentaje/100)),humedad:e(r.lote.humedad*(r.porcentaje/100)),pesoNeto:e((parseFloat(r.lote.pesoBruto)-r.lote.tara-r.lote.humedad)*(r.porcentaje/100)),mineralSus:e(this.costo.mineralSus*(r.porcentaje/100)),regaliaSus:e(this.costo.regaliaSus*(r.porcentaje/100)),mineralBs:e(this.costo.mineralBs*(r.porcentaje/100)),regaliaBs:e(this.costo.regaliaBs*(r.porcentaje/100)),netoSus:e(this.costo.netoSus*(r.porcentaje/100)),netoBs:e(this.costo.netoBs*(r.porcentaje/100)),totalDescuentos:0,totalLiquidacion:0})}),this.auxSubLotes=t}ngOnChanges(t){t.costo&&!t.costo.firstChange&&this.loadAuxSubLotes()}report(){alert("REPORTE COMPLETO")}total(t){return this.subLotes.reduce((e,r)=>e+(r[t]||0),0).toFixed(2)}};d.\u0275fac=function(e){return new(e||d)(y(w),y(He),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-index-subLote"]],viewQuery:function(e,r){if(e&1&&Y($e,5),e&2){let C;X(C=J())&&(r.dialog=C.first)}},inputs:{lote:"lote",subLotes:"subLotes",costo:"costo",descuentos:"descuentos",deducciones:"deducciones"},outputs:{changeSubLote:"changeSubLote"},standalone:!0,features:[re([w,O]),rt,R],decls:5,vars:5,consts:[[4,"ngIf"],[3,"changeSubLote"],[1,"grid"],[1,"col-6"],[1,"prefijoRow"],[1,"col-6","text-right"],["pRipple","","severity","primary","label","Agregar Descuento","icon","pi pi-plus",3,"click","outlined","raised","text"],["dataKey","id",3,"value","rowHover"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","fechaHora",2,"width","20%"],["field","fechaHora"],["pSortableColumn","monto",2,"width","55%"],["field","monto"],["pSortableColumn","monto",2,"width","25%"],[1,"col-4"],[1,"col-4","text-right"],["pRipple","","icon","pi pi-print","severity","info",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"]],template:function(e,r){e&1&&(h(0,zi,12,8,"div",0)(1,Fi,5,0,"div",0),n(2,"app-dialog-subLote",1),g("changeSubLote",function(){return r.show()}),o(),p(3,"p-confirmDialog")(4,"p-toast")),e&2&&(c("ngIf",!r.loading),s(),c("ngIf",r.loading),s(2),L(E(4,Ni)))},dependencies:[U,Z,B,Le,Ie,z,q,$,me,N,V,D,H,P,Q,ye,W,k,j,A,ce,$e]});let a=d;return a})();var Qe=(()=>{let d=class d{constructor(t){this.httpClient=t,this.url="http://127.0.0.1:8000/api/registro/comercializacion/compra/costo/"}index(t){return this.httpClient.get(this.url+"index/"+t)}create(){return this.httpClient.get(this.url+"create")}store(t){return this.httpClient.post(this.url+"store",t)}edit(t){return this.httpClient.get(this.url+"edit/"+t)}update(t){return this.httpClient.put(this.url+"update",t)}};d.\u0275fac=function(e){return new(e||d)(ne(ae))},d.\u0275prov=oe({token:d,factory:d.\u0275fac,providedIn:"root"});let a=d;return a})();var wt=()=>({width:"100%"});function ji(a,d){a&1&&(n(0,"tr")(1,"th",12),l(2,"MINERAL"),o(),n(3,"th",13),l(4,"COTIZACI\xD3N"),o(),n(5,"th",13),l(6,"REGALIA"),o(),n(7,"th",13),l(8,"UNIDAD-MEDIDA"),o(),n(9,"th",14),p(10,"p-tableHeaderCheckbox"),o()())}function Ui(a,d){if(a&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td"),l(8),o(),n(9,"td",15),p(10,"p-tableCheckbox",16),o()()),a&2){let i=d.$implicit;s(2),ie(" ",i.nombre," \xA0 (",i.abreviatura,") "),s(2),S(" ",i.cotizacion15.valorCotizacion," "),s(2),S(" ",i.cotizacion15.valorRegalia," "),s(2),S(" ",i.cotizacion15.unidad_medida.abreviatura," "),s(2),c("value",i)}}function Hi(a,d){a&1&&(n(0,"tr")(1,"th",12),l(2,"MINERAL"),o(),n(3,"th",17),l(4,"COTIZACI\xD3N"),o(),n(5,"th",13),l(6,"UNIDAD-MEDIDA"),o(),n(7,"th",14),p(8,"p-tableHeaderCheckbox"),o()())}function Qi(a,d){if(a&1&&(n(0,"tr")(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),n(7,"td",15),p(8,"p-tableCheckbox",16),o()()),a&2){let i=d.$implicit;s(2),ie(" ",i.nombre," \xA0 (",i.abreviatura,") "),s(2),S(" ",i.cotizacion.valorCotizacion," "),s(2),S(" ",i.cotizacion.unidad_medida.abreviatura," "),s(2),c("value",i)}}function Ki(a,d){if(a&1){let i=b();n(0,"div",3)(1,"h5"),l(2,"\xDAltimas Cotizaciones Quincenales"),o(),p(3,"hr"),n(4,"p-table",4),f("selectionChange",function(e){u(i);let r=m();return v(r.selectedCot15,e)||(r.selectedCot15=e),_(e)}),h(5,ji,11,0,"ng-template",5)(6,Ui,11,6,"ng-template",6),o()(),p(7,"hr"),n(8,"div",3)(9,"h5"),l(10,"\xDAltimas Cotizaciones Diarias"),o(),p(11,"hr"),n(12,"p-table",4),f("selectionChange",function(e){u(i);let r=m();return v(r.selectedCot,e)||(r.selectedCot=e),_(e)}),h(13,Hi,9,0,"ng-template",5)(14,Qi,9,5,"ng-template",6),o()(),p(15,"hr"),n(16,"div",7)(17,"div",8)(18,"label",9),l(19),o()(),n(20,"div",10),p(21,"input",11),o()()}if(a&2){let i=m();s(4),c("value",i.cotizacion15Minerales),x("selection",i.selectedCot15),c("tableStyle",E(10,wt)),s(8),c("value",i.cotizacionMinerales),x("selection",i.selectedCot),c("tableStyle",E(11,wt)),s(7),ie("",i.cotizacionDivisa.nombre," \xA0 (",i.cotizacionDivisa.abreviatura,"): "),s(2),c("value",i.cotizacionDivisa.cotizacion.valor+" Bs.")("disabled",!0)}}function qi(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Guardando..."),o(),p(3,"span",24),o())}function Gi(a,d){if(a&1){let i=b();n(0,"div",18)(1,"div",19),h(2,qi,4,0,"div",20),o(),n(3,"div",21)(4,"p-button",22),g("click",function(){u(i);let e=m();return _(e.save())}),o(),n(5,"p-button",23),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)("hidden",i.saving),s(),c("text",!0)("raised",!0)}}var tt=(()=>{let d=class d{constructor(t,e){this.messageService=t,this.costoService=e,this.changeCosto=new F}showCreate(t,e,r,C){this.cotizacion15Minerales=e,this.cotizacionMinerales=r,this.cotizacionDivisa=C,this.costo={idLote:t,idCotizacionDivisa:C.cotizacion.id,cotizacion15Minerales:[],cotizacionMinerales:[]},this.estado=!0,this.saving=!1}showEdit(t,e,r,C,M){this.cotizacion15Minerales=e,this.cotizacionMinerales=r,this.cotizacionDivisa=C,this.costos=M,this.costo={idLote:t,idCotizacionDivisa:C.cotizacion.id,cotizacion15Minerales:[],cotizacionMinerales:[]},this.updateSelected(),this.estado=!0,this.saving=!1}save(){this.prepareData(),this.saving=!0,this.costos?(console.log("REQUEST->update",this.costo),this.costoService.update(this.costo).subscribe({next:t=>{this.costo=t.costo,this.changeCosto.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->update",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->update Error en:",t.error)}})):(console.log("REQUEST->store",this.costo),this.costoService.store(this.costo).subscribe({next:t=>{this.costo=t.costo,this.changeCosto.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:t.msg}),console.log("RESPONSE->store",t),this.estado=!1},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->store Error en:",t.error)}}))}cancel(){this.estado=!1}prepareData(){this.costo.cotizacion15Minerales=this.selectedCot15.map(t=>({idCotizacion15Mineral:t.cotizacion15.id})),this.costo.cotizacionMinerales=this.selectedCot.map(t=>({idCotizacionMineral:t.cotizacion.id}))}updateSelected(){this.selectedCot15=[],this.cotizacion15Minerales.forEach(t=>{this.costos.forEach(e=>{t.id==e.cotizacion15_mineral.idMineral&&this.selectedCot15.push(t)})}),this.selectedCot=[],this.cotizacionMinerales.forEach(t=>{this.costos.forEach(e=>{t.id==e.cotizacion_mineral.idMineral&&this.selectedCot.push(t)})})}};d.\u0275fac=function(e){return new(e||d)(y(w),y(Qe))},d.\u0275cmp=I({type:d,selectors:[["app-dialog-costo"]],outputs:{changeCosto:"changeCosto"},standalone:!0,features:[R],decls:3,vars:3,consts:[["closeOnEscape","true","closable","true","header","REGISTRO DE COTIZACIONES","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal","draggable"],["pTemplate","content"],["pTemplate","footer"],[1,"card-body","shadow-3"],["dataKey","id",3,"selectionChange","value","selection","tableStyle"],["pTemplate","header"],["pTemplate","body"],[1,"field","grid"],[1,"col-8","text-right","pt-3"],["for","divisa"],[1,"col-4"],["type","text","pInputText","","id","divisa",1,"w-full",3,"value","disabled"],[2,"width","30%"],[2,"width","20%"],[1,"text-center",2,"width","10%"],[1,"text-center"],[3,"value"],[2,"width","40%"],[1,"grid","custom-footer"],[1,"col-6","text-left"],[4,"ngIf"],[1,"col-6"],["pRipple","","label","Guardar","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Cancelar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,Ki,22,12,"ng-template",1)(2,Gi,6,6,"ng-template",2),o()),e&2&&(x("visible",r.estado),c("modal",!0)("draggable",!1))},dependencies:[z,te,B,U,Z,ut,_t,V,D,H,ee,P,W,N,k,K,j,A]});let a=d;return a})();var Zi=()=>({width:"450px"}),Mt=()=>({width:"200px"}),Yi=()=>({width:"100%"});function Xi(a,d){if(a&1){let i=b();n(0,"p-button",8),g("click",function(){u(i);let e=m();return _(e.showCreate())}),o()}a&2&&(L(E(5,Mt)),c("outlined",!0)("raised",!0)("text",!0))}function Ji(a,d){if(a&1){let i=b();n(0,"p-button",9),g("click",function(){u(i);let e=m();return _(e.showEdit())}),o()}a&2&&(L(E(5,Mt)),c("outlined",!0)("raised",!0)("text",!0))}function $i(a,d){a&1&&(n(0,"tr")(1,"th",19),l(2,"MINERAL"),o(),n(3,"th",20),l(4,"COTIZACI\xD3N"),o(),n(5,"th",20),l(6,"REGALIA"),o(),n(7,"th",20),l(8,"UNIDAD-MEDIDA"),o()())}function eo(a,d){if(a&1&&(n(0,"tr")(1,"td")(2,"b"),l(3),o(),p(4,"br"),n(5,"span",2),l(6,"FECHA: "),o(),l(7),o(),n(8,"td"),l(9),o(),n(10,"td"),l(11),o(),n(12,"td"),l(13),o()()),a&2){let i=d.$implicit;s(3),ie(" ",i.cotizacion15_mineral.mineral.nombre," \xA0 (",i.cotizacion15_mineral.mineral.abreviatura,") "),s(4),S(" ",i.cotizacion15_mineral.cotizacion15.fecha," "),s(2),S(" ",i.cotizacion15_mineral.valorCotizacion," "),s(2),S(" ",i.cotizacion15_mineral.valorRegalia," "),s(2),S(" ",i.cotizacion15_mineral.unidad_medida.abreviatura," ")}}function to(a,d){a&1&&(n(0,"tr")(1,"th",19),l(2,"MINERAL"),o(),n(3,"th",19),l(4,"COTIZACI\xD3N"),o(),n(5,"th",20),l(6,"UNIDAD-MEDIDA"),o()())}function io(a,d){if(a&1&&(n(0,"tr")(1,"td")(2,"b"),l(3),o(),p(4,"br"),n(5,"span",2),l(6,"FECHA: "),o(),l(7),o(),n(8,"td"),l(9),o(),n(10,"td"),l(11),o()()),a&2){let i=d.$implicit;s(3),ie(" ",i.cotizacion_mineral.mineral.nombre," \xA0 (",i.cotizacion_mineral.mineral.abreviatura,") "),s(4),S(" ",i.cotizacion_mineral.cotizacion.fecha," "),s(2),S(" ",i.cotizacion_mineral.valorCotizacion," "),s(2),S(" ",i.cotizacion_mineral.unidad_medida.abreviatura," ")}}function oo(a,d){if(a&1&&(n(0,"div")(1,"h5"),l(2,"\xDAltimas Cotizaciones Quincenales"),o(),p(3,"hr"),n(4,"p-table",10),h(5,$i,9,0,"ng-template",11)(6,eo,14,6,"ng-template",12),o(),p(7,"hr"),n(8,"h5"),l(9,"\xDAltimas Cotizaciones Diarias"),o(),p(10,"hr"),n(11,"p-table",13),h(12,to,7,0,"ng-template",11)(13,io,12,5,"ng-template",12),o(),p(14,"hr"),n(15,"div",14)(16,"div",15)(17,"label",16),l(18," DOLAR (US$): "),o()(),n(19,"div",17),p(20,"input",18),o()()()),a&2){let i=m();s(4),c("value",i.costos)("rowHover",!0),s(7),c("value",i.costos)("tableStyle",E(6,Yi)),s(9),c("value",(i.costos.length>0?i.costos[0].cotizacion_divisa.valor:"")+" Bs.")("disabled",!0)}}function no(a,d){a&1&&(n(0,"div")(1,"div",21),p(2,"p-progressSpinner",22),n(3,"span",23),l(4,"Cargando..."),o()()())}var Lt=(()=>{let d=class d{constructor(t,e,r){this.messageService=t,this.costoService=e,this.confirmationService=r,this.changeCostos=new F}show(){this.estado=!0,this.loading=!0,console.log("REQUEST->index"),this.costoService.index(this.lote.id).subscribe({next:t=>{this.costos=t.costos,this.changeCostos.emit(t.costos),console.log("RESPONSE->index",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->index Error en:",t.error)},complete:()=>{this.loading=!1}})}showCreate(){this.dialog.showCreate(this.lote.id,this.cotizacion15Minerales,this.cotizacionMinerales,this.cotizacionDivisa)}showEdit(){this.dialog.showEdit(this.lote.id,this.cotizacion15Minerales,this.cotizacionMinerales,this.cotizacionDivisa,this.costos)}};d.\u0275fac=function(e){return new(e||d)(y(w),y(Qe),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-index-costo"]],viewQuery:function(e,r){if(e&1&&Y(tt,5),e&2){let C;X(C=J())&&(r.dialog=C.first)}},inputs:{lote:"lote",cotizacionMinerales:"cotizacionMinerales",cotizacion15Minerales:"cotizacion15Minerales",cotizacionDivisa:"cotizacionDivisa",costos:"costos"},outputs:{changeCostos:"changeCostos"},standalone:!0,features:[re([w,O]),R],decls:14,vars:6,consts:[[1,"grid"],[1,"col-6"],[1,"prefijoRow"],[1,"col-6","text-right"],["pRipple","","severity","primary","label","Agregar Cotizaci\xF3n","icon","pi pi-plus",3,"outlined","raised","text","style"],["pRipple","","severity","primary","label","Editar Cotizaci\xF3n","icon","pi pi-pencil",3,"outlined","raised","text","style"],[4,"ngIf"],[3,"changeCosto"],["pRipple","","severity","primary","label","Agregar Cotizaci\xF3n","icon","pi pi-plus",3,"click","outlined","raised","text"],["pRipple","","severity","primary","label","Editar Cotizaci\xF3n","icon","pi pi-pencil",3,"click","outlined","raised","text"],["dataKey","id",3,"value","rowHover"],["pTemplate","header"],["pTemplate","body"],["dataKey","id",3,"value","tableStyle"],[1,"field","grid"],[1,"col-8","text-right","pt-3"],["for","divisa"],[1,"col-4"],["type","text","pInputText","","id","divisa",1,"w-full",3,"value","disabled"],[2,"width","40%"],[2,"width","20%"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"h3")(3,"span",2),l(4,"Cotizaciones"),o()()(),n(5,"div",3),h(6,Xi,1,6,"p-button",4)(7,Ji,1,6,"p-button",5),o()(),p(8,"hr"),h(9,oo,21,7,"div",6)(10,no,5,0,"div",6),n(11,"app-dialog-costo",7),g("changeCosto",function(){return r.show()}),o(),p(12,"p-confirmDialog")(13,"p-toast")),e&2&&(s(6),Ee(r.costos.length?7:6),s(3),c("ngIf",!r.loading),s(),c("ngIf",r.loading),s(2),L(E(5,Zi)))},dependencies:[U,Z,B,z,q,$,me,N,V,D,H,P,Q,ye,W,k,K,j,A,ce,tt]});let a=d;return a})();var ro=()=>({width:"95vw"}),It=()=>({width:"200px"}),De=()=>({width:"130px"});function ao(a,d){if(a&1){let i=b();n(0,"div")(1,"div")(2,"p-button",4),g("click",function(){u(i);let e=m(2);return _(e.aceptarCompra())}),o(),l(3," \xA0 "),n(4,"p-button",5),g("click",function(){u(i);let e=m(2);return _(e.rechazarCompra())}),o()(),p(5,"hr"),n(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),p(10,"img",10),n(11,"h2"),l(12),o(),p(13,"hr")(14,"hr"),o(),n(15,"div",11)(16,"div",12)(17,"label",13),l(18,"Mineral : "),o()(),n(19,"div",14)(20,"input",15),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.mineral.nombre,e)||(r.lote.mineral.nombre=e),_(e)}),o()()(),n(21,"div",11)(22,"div",12)(23,"label",16),l(24,"Sacos : "),o()(),n(25,"div",14)(26,"input",17),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.sacos,e)||(r.lote.sacos=e),_(e)}),o()()(),n(27,"div",11)(28,"div",12)(29,"label",18),l(30,"FECHA : "),o()(),n(31,"div",14)(32,"input",19),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.fechaHora,e)||(r.lote.fechaHora=e),_(e)}),o()()(),n(33,"div",11)(34,"div",12)(35,"label",20),l(36,"Cooperativa : "),o()(),n(37,"div",14)(38,"input",21),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.cooperativa.nombre,e)||(r.lote.cooperativa.nombre=e),_(e)}),o()()(),n(39,"div",11)(40,"div",12)(41,"label",22),l(42,"Socio : "),o()(),n(43,"div",14)(44,"input",23),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.socio.nombre,e)||(r.lote.socio.nombre=e),_(e)}),o()()(),n(45,"div",11)(46,"div",12)(47,"label",24),l(48,"Peso Bruto (Kg) : "),o()(),n(49,"div",14)(50,"input",25),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.pesoBruto,e)||(r.lote.pesoBruto=e),_(e)}),o()()(),n(51,"div",11)(52,"div",12)(53,"label",26),l(54,"Tara (Kg) : "),o()(),n(55,"div",14)(56,"input",27),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.tara,e)||(r.lote.tara=e),_(e)}),o()()(),n(57,"div",11)(58,"div",28)(59,"label",29),l(60,"Humedad (Kg) : "),o()(),n(61,"div",14)(62,"input",30),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.lote.humedad,e)||(r.lote.humedad=e),_(e)}),o()()(),n(63,"div",11)(64,"div",12)(65,"label",31),l(66,"Peso Neto (Kg) : "),o()(),n(67,"div",14),p(68,"input",32),o()(),n(69,"div",33)(70,"div",12)(71,"label",34),l(72,"Moliendero : "),o()(),n(73,"div",14),p(74,"input",35),o()(),p(75,"hr"),n(76,"div",36)(77,"h5"),l(78,"PRECIOS TOTALES"),o(),p(79,"hr"),n(80,"table",37)(81,"thead")(82,"tr"),p(83,"th",38),n(84,"th",39),l(85," $us. "),o(),n(86,"th",39),l(87," Bs. "),o()()(),n(88,"tbody")(89,"tr")(90,"td")(91,"label"),l(92,"Bruto :\xA0"),o()(),n(93,"td")(94,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.mineralSus,e)||(r.costo.mineralSus=e),_(e)}),o()(),n(95,"td")(96,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.mineralBs,e)||(r.costo.mineralBs=e),_(e)}),o()()(),n(97,"tr")(98,"td")(99,"label"),l(100,"Regalia :\xA0"),o()(),n(101,"td")(102,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.regaliaSus,e)||(r.costo.regaliaSus=e),_(e)}),o()(),n(103,"td")(104,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.regaliaBs,e)||(r.costo.regaliaBs=e),_(e)}),o()()(),n(105,"tr")(106,"td")(107,"label"),l(108,"L\xEDquido :\xA0"),o()(),n(109,"td")(110,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.netoSus,e)||(r.costo.netoSus=e),_(e)}),o()(),n(111,"td")(112,"input",40),f("ngModelChange",function(e){u(i);let r=m(2);return v(r.costo.netoBs,e)||(r.costo.netoBs=e),_(e)}),o()()()()()()()(),n(113,"div",41)(114,"div",8)(115,"p-tabView",42),f("activeIndexChange",function(e){u(i);let r=m(2);return v(r.activeIndex,e)||(r.activeIndex=e),_(e)}),n(116,"p-tabPanel",43),p(117,"app-index-descuento",44)(118,"hr"),n(119,"div",45)(120,"p-button",46),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=1)}),o()()(),n(121,"p-tabPanel",47)(122,"app-index-costo",48),g("changeCostos",function(e){u(i);let r=m(2);return _(r.updateCostos(e))}),o(),p(123,"hr"),n(124,"div",45)(125,"p-button",49),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=0)}),o(),l(126,"\xA0 "),n(127,"p-button",46),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=2)}),o()()(),n(128,"p-tabPanel",50)(129,"app-index-ley",51),g("changeLeyes",function(e){u(i);let r=m(2);return _(r.updateLeyes(e))}),o(),p(130,"hr"),n(131,"div",45)(132,"p-button",49),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=1)}),o(),l(133,"\xA0 "),n(134,"p-button",46),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=3)}),o()()(),n(135,"p-tabPanel",52)(136,"app-index-subLote",53),g("changeSubLote",function(e){u(i);let r=m(2);return _(r.updateSubLotes(e))}),o(),p(137,"hr"),n(138,"div",45)(139,"p-button",49),g("onClick",function(){u(i);let e=m(2);return _(e.activeIndex=2)}),o()()()()()()()()}if(a&2){let i=m(2);s(2),L(E(81,It)),c("text",!0)("raised",!0)("hidden",!i.estadoLote),s(2),L(E(82,It)),c("text",!0)("raised",!0),s(6),c("src",i.lote.mineral.foto,Oe),s(2),S("LOTE: ",i.lote.numLote,""),s(8),x("ngModel",i.lote.mineral.nombre),c("disabled",!0),s(6),x("ngModel",i.lote.sacos),c("disabled",!0),s(6),x("ngModel",i.lote.fechaHora),c("disabled",!0),s(6),x("ngModel",i.lote.cooperativa.nombre),c("disabled",!0),s(6),x("ngModel",i.lote.socio.nombre),c("disabled",!0),s(6),x("ngModel",i.lote.pesoBruto),c("disabled",!0),s(6),x("ngModel",i.lote.tara),c("disabled",!0),s(6),x("ngModel",i.lote.humedad),c("disabled",!0),s(6),c("value",i.lote.pesoBruto-i.lote.tara-i.lote.humedad)("disabled",!0),s(6),c("value",i.lote.moliendero==null?null:i.lote.moliendero.nombre)("disabled",!0),s(20),c("disabled",!0),x("ngModel",i.costo.mineralSus),s(2),c("disabled",!0),x("ngModel",i.costo.mineralBs),s(6),c("disabled",!0),x("ngModel",i.costo.regaliaSus),s(2),c("disabled",!0),x("ngModel",i.costo.regaliaBs),s(6),c("disabled",!0),x("ngModel",i.costo.netoSus),s(2),c("disabled",!0),x("ngModel",i.costo.netoBs),s(3),x("activeIndex",i.activeIndex),s(2),c("lote",i.lote)("descuentos",i.descuentos)("deducciones",i.deducciones),s(3),L(E(83,De)),c("rounded",!0)("outlined",!0),s(2),c("lote",i.lote)("cotizacionMinerales",i.cotizacionMinerales)("cotizacion15Minerales",i.cotizacion15Minerales)("cotizacionDivisa",i.cotizacionDivisa)("costos",i.costos),s(3),L(E(84,De)),c("rounded",!0)("outlined",!0),s(2),L(E(85,De)),c("rounded",!0)("outlined",!0),s(2),c("lote",i.lote)("leyes",i.leyes),s(3),L(E(86,De)),c("rounded",!0)("outlined",!0),s(2),L(E(87,De)),c("rounded",!0)("outlined",!0),s(2),c("lote",i.lote)("subLotes",i.subLotes)("costo",i.costo),s(3),L(E(88,De)),c("rounded",!0)("outlined",!0)}}function lo(a,d){a&1&&(n(0,"div")(1,"div",54),p(2,"p-progressSpinner",55),n(3,"span",56),l(4,"Cargando..."),o()()())}function so(a,d){if(a&1&&(p(0,"hr"),h(1,ao,140,89,"div",3)(2,lo,5,0,"div",3)),a&2){let i=m();s(),c("ngIf",!i.loading),s(),c("ngIf",i.loading)}}function co(a,d){a&1&&(n(0,"div")(1,"h5"),l(2,"Cerrando Compra..."),o(),p(3,"span",61),o())}function mo(a,d){if(a&1){let i=b();n(0,"div",57)(1,"div",58),h(2,co,4,0,"div",3),o(),n(3,"div",59)(4,"p-button",60),g("click",function(){u(i);let e=m();return _(e.cancel())}),o()()()}if(a&2){let i=m();s(2),c("ngIf",i.saving),s(2),c("text",!0)("raised",!0)}}var it=(()=>{let d=class d{constructor(t,e,r){this.messageService=t,this.loteService=e,this.confirmationService=r,this.changeShow=new F}show(t){this.estado=!0,this.loading=!0,this.saving=!1,this.activeIndex=0,this.estadoLote=!1,console.log("REQUEST->show",t),this.loteService.show(t).subscribe({next:e=>{this.lote=e.lote,this.subLotes=e.subLotes,this.costos=e.costos,this.descuentos=e.descuentos,this.deducciones=e.deducciones,this.leyes=e.leyes,this.cotizacionMinerales=e.cotizacionMinerales,this.cotizacion15Minerales=e.cotizacion15Minerales,this.cotizacionDivisa=e.cotizacionDivisa,this.calcularPrecios(),this.updateEstadoLote(),console.log("RESPONSE->show",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->show Error en:",e.error)},complete:()=>{this.loading=!1}})}cancel(){this.estado=!1,this.changeShow.emit()}updateLeyes(t){this.leyes=t,this.calcularPrecios(),this.updateEstadoLote()}updateCostos(t){this.costos=t,this.calcularPrecios(),this.updateEstadoLote()}updateSubLotes(t){this.subLotes=t,this.updateEstadoLote()}calcularPrecios(){let t=2.20462,e=14.5833,r=parseFloat(this.lote.pesoBruto)-this.lote.tara-this.lote.humedad;this.costo={mineralSus:0,regaliaSus:0,mineralBs:0,regaliaBs:0,netoSus:0,netoBs:0};let C=0,M=0,ve=Ve=>parseFloat(Ve.toFixed(2));this.leyes?.forEach(Ve=>{Ve.idSolicitante===4&&Ve.detalles&&this.costos.length>0&&Ve.detalles.forEach(fe=>{let Ke=this.costos.find(ge=>ge.cotizacion_mineral.idMineral===fe.idMineral).cotizacion_mineral.valorCotizacion,Rt=this.costos.find(ge=>ge.cotizacion_mineral.idMineral===fe.idMineral).cotizacion_mineral.unidad_medida.abreviatura,qe=this.costos.find(ge=>ge.cotizacion15_mineral.idMineral===fe.idMineral).cotizacion15_mineral.valorCotizacion,Dt=this.costos.find(ge=>ge.cotizacion15_mineral.idMineral===fe.idMineral).cotizacion15_mineral.valorRegalia,Vt=this.costos.find(ge=>ge.cotizacion15_mineral.idMineral===fe.idMineral).cotizacion15_mineral.unidad_medida.abreviatura,nt=this.costos[0].cotizacion_divisa.valor;fe.idUnidadMedidaLey==1?(C=fe.valor/100,M=r*C*t):(C=fe.valor/100/100,M=r*C*t*e),Rt=="\xA2US$ / LF"&&(Ke=Ke/100),Vt=="\xA2US$ / LF"&&(qe=qe/100),this.costo.mineralSus=ve(this.costo.mineralSus+ve(M*Ke)),this.costo.regaliaSus=ve(this.costo.regaliaSus+ve(M*qe*(Dt/100))),this.costo.mineralBs=ve(this.costo.mineralSus*nt),this.costo.regaliaBs=ve(this.costo.regaliaSus*nt),this.costo.netoSus=ve(this.costo.mineralSus-this.costo.regaliaSus),this.costo.netoBs=ve(this.costo.mineralBs-this.costo.regaliaBs)})})}updateEstadoLote(){this.costos.length&&this.leyes.length&&this.subLotes.length&&(this.estadoLote=!0)}aceptarCompra(){this.confirmationService.confirm({message:`      
      <div class="text-center">
          <i class="pi pi-check icon-aceptar"></i>
      </div>
      <h3>Si acepta la compra, ya no podr\xE1 modificarla...!!</h3>
      `,header:"Confirmar",accept:()=>{this.updateEstadoCompra({idLote:this.lote.id,codigo:"1.1"})}})}rechazarCompra(){this.confirmationService.confirm({message:`      
      <div class="text-center">
          <i class="pi pi-times icon-rechazar"></i>
      </div>
      <h3>Si rechaza la compra, ya no podr\xE1 modificarla...!!</h3>
      `,header:"Confirmar",accept:()=>{this.updateEstadoCompra({idLote:this.lote.id,codigo:"1.2"})}})}updateEstadoCompra(t){this.saving=!0,console.log("REQUEST->updateState",this.lote.id),this.loteService.updateState(t).subscribe({next:e=>{this.lote=e.lote,this.changeShow.emit(),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:e.msg}),console.log("RESPONSE->updateState",e),this.estado=!1},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->updateState Error en:",e.error)}})}};d.\u0275fac=function(e){return new(e||d)(y(w),y(Te),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-show-lote"]],viewQuery:function(e,r){if(e&1&&Y(et,5),e&2){let C;X(C=J())&&(r.indexSubLote=C.first)}},outputs:{changeShow:"changeShow"},standalone:!0,features:[R],decls:3,vars:6,consts:[["closeOnEscape","false","closable","false","header","DETALLE DE COMPRA","styleClass","p-fluid dialog-responsive custom-header",3,"visibleChange","visible","modal","maximizable"],["pTemplate","content"],["pTemplate","footer"],[4,"ngIf"],["pRipple","","label","Aceptar Compra","icon","pi pi-check","severity","primary",3,"click","text","raised","hidden"],["pRipple","","label","Rechazar Compra","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"grid","pb-3"],[1,"col-12","sm:col-4"],[1,"card-body","shadow-3",2,"min-height","1200px"],[1,"text-center"],["alt","Foto-Mineral",2,"width","150px","height","150px","border-radius","100px","border","3px solid #dcdcdc",3,"src"],[1,"field","grid"],[1,"col-4","text-right","pt-3"],["for","mineral"],[1,"col-8"],["type","text","pInputText","","id","mineral",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","sacos"],["type","text","pInputText","","id","sacos",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","fecha"],["type","text","pInputText","","id","fecha",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","cooperativa"],["type","text","pInputText","","id","cooperativa",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","socio"],["type","text","pInputText","","id","socio",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","pesoBruto"],["type","number","pInputText","","id","pesoBruto",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","tara"],["type","number","pInputText","","id","tara",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"col-4","text-right","pt-2"],["for","humedad"],["type","number","pInputText","","id","humedad",1,"w-full",3,"ngModelChange","ngModel","disabled"],["for","pesoNeto"],["type","number","pInputText","","id","pesoBruto",1,"w-full",3,"value","disabled"],[1,"grid"],["for","idMoliendero"],["type","text","pInputText","","id","idMoliendero",1,"w-full",3,"value","disabled"],[1,"card"],[1,"table"],[2,"width","30%"],[2,"background","#dcdcdc","padding","5px","width","35%"],["type","text","pInputText","","id","mineral",1,"text-right",3,"ngModelChange","disabled","ngModel"],[1,"col-12","sm:col-8"],[3,"activeIndexChange","activeIndex"],["header","DESCUENTOS"],[3,"lote","descuentos","deducciones"],[1,"text-right","mt-3"],["label","Siguiente","severity","success","icon","pi pi-arrow-right","iconPos","right",3,"onClick","rounded","outlined"],["header","COTIZACIONES"],[3,"changeCostos","lote","cotizacionMinerales","cotizacion15Minerales","cotizacionDivisa","costos"],["label","Anterior","severity","success","icon","pi pi-arrow-left","iconPos","left",3,"onClick","rounded","outlined"],["header","LEYES"],[3,"changeLeyes","lote","leyes"],["header","LIQUIDACIONES"],[3,"changeSubLote","lote","subLotes","costo"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","30vh"],["ariaLabel","loading"],[1,"loader","ps-5"],[1,"grid","custom-footer"],[1,"col-6","text-left"],[1,"col-6"],["pRipple","","label","Cerrar","icon","pi pi-times","severity","warning",3,"click","text","raised"],[1,"saving"]],template:function(e,r){e&1&&(n(0,"p-dialog",0),f("visibleChange",function(M){return v(r.estado,M)||(r.estado=M),M}),h(1,so,3,2,"ng-template",1)(2,mo,5,3,"ng-template",2),o()),e&2&&(L(E(5,ro)),x("visible",r.estado),c("modal",!0)("maximizable",!0))},dependencies:[z,q,xt,ht,gt,B,$,N,Q,te,U,pt,V,D,H,ee,P,le,Se,se,de,W,k,K,j,A,St,yt,et,Lt]});let a=d;return a})();var po=()=>({width:"450px"}),Tt=()=>({width:"100%"}),uo=()=>[10,25,50],_o=()=>["numLote","fechaHora","cooperativa.nombre","mineral.nombre","pesoBruto","estado"],go=()=>({"min-width":"75rem"});function ho(a,d){if(a&1){let i=b();n(0,"div",18)(1,"div",19)(2,"p-button",20),g("click",function(){u(i);let e=m(2);return _(e.showCreate())}),o(),n(3,"p-button",21),g("click",function(){u(i);let e=m(2);return _(e.exportXLS())}),o()(),n(4,"div",22)(5,"span",23),p(6,"i",24),n(7,"input",25),g("input",function(e){u(i),m();let r=at(17);return _(r.filterGlobal(e.target.value,"contains"))}),o()()()()}a&2&&(s(2),c("outlined",!0)("raised",!0)("text",!0),s(),c("outlined",!0)("raised",!0)("text",!0))}function xo(a,d){a&1&&(n(0,"tr")(1,"th",26),l(2," LOTE "),p(3,"p-sortIcon",27),o(),n(4,"th",28),l(5," DATOS-COMPRA "),p(6,"p-sortIcon",29),o(),n(7,"th",30),l(8," PRODUCTO "),p(9,"p-sortIcon",31),o(),n(10,"th",32),l(11," SUBLOTES "),p(12,"p-sortIcon",31),o(),n(13,"th",33),l(14," ESTADO "),p(15,"p-sortIcon",31),o(),n(16,"th",34),l(17," OPCIONES "),o()())}function vo(a,d){if(a&1&&(n(0,"span",35)(1,"font",36),l(2),o()(),p(3,"br"),l(4),p(5,"hr")),a&2){let i=d.$implicit;s(),c("size",5),s(),S("",i==null?null:i.porcentaje," %"),s(2),S("",i==null?null:i.socio.nombre," ")}}function fo(a,d){if(a&1&&(n(0,"h5")(1,"span",40),l(2),o()()),a&2){let i=m().$implicit;s(2),T(i.estado_lote.nombre)}}function So(a,d){if(a&1&&(n(0,"h5")(1,"span",41),l(2),o()()),a&2){let i=m(2).$implicit;s(2),T(i.estado_lote.nombre)}}function Co(a,d){if(a&1&&(n(0,"h5"),l(1),o()),a&2){let i=m(2).$implicit;s(),T(i.estado_lote.nombre)}}function yo(a,d){if(a&1&&h(0,So,3,1,"h5")(1,Co,2,1,"h5"),a&2){let i=m().$implicit;Ee(i.estado_lote.codigo=="1.1"||i.estado_lote.codigo=="2.1"||i.estado_lote.codigo=="3.1"?0:1)}}function Eo(a,d){if(a&1){let i=b();n(0,"tr")(1,"td")(2,"h2"),l(3),o()(),n(4,"td")(5,"span",35),l(6,"REGIONAL: "),o(),l(7),p(8,"br"),n(9,"span",35),l(10,"SUCURSAL: "),o(),l(11),p(12,"br")(13,"hr"),n(14,"span",35),l(15,"USUARIO: "),o(),l(16),p(17,"br"),n(18,"span",35),l(19,"FECHA: "),o(),l(20),he(21,"date"),p(22,"br"),n(23,"span",35),l(24,"HORA: "),o(),l(25),he(26,"date"),p(27,"hr"),n(28,"span",35),l(29,"COOPERATIVA: "),o(),l(30),p(31,"br"),n(32,"span",35),l(33,"SOCIO: "),o(),l(34),o(),n(35,"td")(36,"span",35)(37,"font",36),l(38),o()(),p(39,"br")(40,"hr"),n(41,"span",35),l(42,"K-BRUTO: "),o(),l(43),p(44,"br"),n(45,"span",35),l(46,"TARA: "),o(),l(47),p(48,"br"),n(49,"span",35),l(50,"HUMEDAD: "),o(),l(51),p(52,"br"),n(53,"span",35),l(54,"K-NETO: "),o(),l(55),p(56,"hr"),o(),n(57,"td"),Ne(58,vo,6,3,null,null,Be),o(),n(60,"td"),h(61,fo,3,1,"h5")(62,yo,2,1),o(),n(63,"td")(64,"p-button",37),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDetail(e.id))}),o(),n(65,"p-button",38),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showEdit(e.id))}),o(),n(66,"p-button",39),g("click",function(){let e=u(i).$implicit,r=m(2);return _(r.showDelete(e.id))}),o()()()}if(a&2){let i=d.$implicit;s(3),T(i.numLote),s(4),S("",i.regional.nombre," "),s(4),S("",i.sucursal.nombre," "),s(5),S("",i.usuario.login," "),s(4),T(xe(21,21,i.fechaHora,"dd/MM/yyyy")),s(5),S("",xe(26,24,i.fechaHora,"HH:mm:ss")," "),s(5),S("",i.cooperativa.nombre," "),s(4),S(" ",i.socio.nombre," "),s(3),c("size",5),s(),T(i.mineral.nombre),s(5),S(" ",i.pesoBruto,""),s(4),S(" ",i.tara,""),s(4),S(" ",i.humedad,""),s(4),S(" ",i.pesoBruto-(i.tara+i.humedad)," "),s(3),We(i.sub_lotes),s(3),Ee(i.estado_lote.codigo=="1.2"||i.estado_lote.codigo=="2.2"||i.estado_lote.codigo=="3.2"?61:62),s(3),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0),s(),c("rounded",!0)("outlined",!0)}}function bo(a,d){if(a&1){let i=b();n(0,"div")(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"div",10)(6,"label"),l(7,"Regional:"),o()(),n(8,"div",11)(9,"p-dropdown",12),g("onChange",function(e){u(i);let r=m();return _(r.filterByRegional(e.value))})("onClear",function(){u(i);let e=m();return _(e.clearFilterRegional())}),o()()(),n(10,"div",9)(11,"div",10)(12,"label"),l(13,"Sucursal:"),o()(),n(14,"div",11)(15,"p-dropdown",13),g("onChange",function(e){u(i);let r=m();return _(r.filterBySucursal(e.value))})("onClear",function(){u(i);let e=m();return _(e.clearFilterSucursal())}),o()()()()(),n(16,"p-table",14,0),h(18,ho,8,6,"ng-template",15)(19,xo,18,0,"ng-template",16)(20,Eo,67,27,"ng-template",17),o()()()}if(a&2){let i=m();s(9),L(E(16,Tt)),c("options",i.regionales)("showClear",!0),s(6),L(E(17,Tt)),c("options",i.sucursales)("showClear",!0),s(),c("value",i.lotes)("rows",10)("rowsPerPageOptions",E(18,uo))("paginator",!0)("globalFilterFields",E(19,_o))("tableStyle",E(20,go))("rowHover",!0)("showCurrentPageReport",!0)}}function wo(a,d){a&1&&(n(0,"div")(1,"div",42),p(2,"p-progressSpinner",43),n(3,"span",44),l(4,"MINEXA S.R.L."),o()()())}var ot=(()=>{let d=class d{constructor(t,e,r,C){this.route=t,this.loteService=e,this.messageService=r,this.confirmationService=C,this.loading=!1}ngOnInit(){this.show()}show(){this.loading=!0,console.log("REQUEST->index"),this.loteService.index().subscribe({next:t=>{this.regionales=t.regionales,this.sucursales=[],this.lotes=t.lotes,this.dataCompleto=t.lotes,console.log("RESPONSE->index",t)},error:t=>{this.messageService.add({severity:"error",summary:"ERROR",detail:t.error.message}),console.log("RESPONSE->index Error en:",t.error)},complete:()=>{this.loading=!1}})}showCreate(){this.dialog.showCreate()}showEdit(t){this.dialog.showEdit(t)}showDelete(t){this.confirmationService.confirm({message:"Est\xE1 seguro de eliminar el Registro...?",header:"Confirmar",icon:"pi pi-exclamation-triangle",accept:()=>{console.log("REQUEST->destroy",t),this.loteService.destroy(t).subscribe({next:e=>{this.lotes=this.lotes.filter(r=>r.id!==t),this.messageService.add({severity:"success",summary:"CONFIRMACI\xD3N",detail:e.msg,life:3e3}),console.log("RESPONSE->destroy",e)},error:e=>{this.messageService.add({severity:"error",summary:"ERROR",detail:e.error.message}),console.log("RESPONSE->destroy Error en:",e.error)}})}})}showDetail(t){this.detail.show(t)}showDescuentos(t){}showLeyes(t){this.route.navigateByUrl("registro/comercializacion/ingreso/sublote/index/"+t,{skipLocationChange:!0})}showSublotes(t){this.route.navigateByUrl("registro/comercializacion/ingreso/sublote/index/"+t,{skipLocationChange:!0})}showReport(t){alert("showReport"+t)}exportXLS(){alert("exportXLS")}loadSucursales(t){let e=this.regionales.find(r=>r.id===t);this.sucursales=e?e.sucursales:[]}filterByRegional(t){this.lotes=this.dataCompleto.filter(e=>e.idRegional==t),this.dataFiltrado=this.lotes,this.loadSucursales(t)}filterBySucursal(t){this.lotes=this.dataCompleto.filter(e=>e.idSucursal==t)}clearFilterRegional(){this.lotes=this.dataCompleto}clearFilterSucursal(){this.lotes=this.dataFiltrado}};d.\u0275fac=function(e){return new(e||d)(y(st),y(Te),y(w),y(O))},d.\u0275cmp=I({type:d,selectors:[["app-index-lote"]],viewQuery:function(e,r){if(e&1&&(Y(it,5),Y(Ye,5)),e&2){let C;X(C=J())&&(r.detail=C.first),X(C=J())&&(r.dialog=C.first)}},standalone:!0,features:[re([w,O]),R],decls:12,vars:5,consts:[["dt",""],[1,"card-header","shadow-5"],[4,"ngIf"],[1,"card-footer"],[3,"changeLote"],[3,"changeShow"],[1,"card-body","shadow-5"],[1,"grid","flex","justify-content-center"],[1,"col-10"],[1,"grid","field"],[1,"col-4","text-right","pt-2"],[1,"col-6"],["id","idRegional","optionValue","id","optionLabel","nombre","placeholder","TODOS",3,"onChange","onClear","options","showClear"],["id","idSucursal","optionValue","id","optionLabel","nombre",3,"onChange","onClear","options","showClear"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","rowsPerPageOptions","paginator","globalFilterFields","tableStyle","rowHover","showCurrentPageReport"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"grid"],[1,"col-12","md:col-8"],["pRipple","","severity","primary","label","Nuevo","icon","pi pi-plus",3,"click","outlined","raised","text"],["pRipple","","severity","info","label","Reporte","icon","pi pi-print",1,"ml-2",3,"click","outlined","raised","text"],[1,"col-12","md:col-4","text-right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",1,"w-full",3,"input"],["pSortableColumn","numLote",2,"width","10%"],["field","numLote"],["pSortableColumn","fechaHora",2,"width","25%"],["field","fechaHora"],["pSortableColumn","mineral.nombre",2,"width","20%"],["field","mineral.nombre"],["pSortableColumn","mineral.nombre",2,"width","15%"],["pSortableColumn","mineral.nombre",2,"width","10%"],[2,"width","20%"],[1,"prefijoRow"],[3,"size"],["pRipple","","icon","pi pi-bars","severity","info",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","rounded","outlined"],["pRipple","","icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[2,"color","red"],[2,"color","green"],[1,"card","mt-3","flex","flex-column","justify-content-center","align-items-center",2,"height","50vh"],["ariaLabel","loading"],[1,"loader","ps-5"]],template:function(e,r){e&1&&(n(0,"div",1)(1,"h3"),l(2,"Gesti\xF3n de Compras"),o()(),p(3,"hr"),h(4,bo,21,21,"div",2),p(5,"hr"),n(6,"div",3)(7,"app-dialog-lote",4),g("changeLote",function(){return r.show()}),o(),n(8,"app-show-lote",5),g("changeShow",function(){return r.show()}),o(),p(9,"p-confirmDialog")(10,"p-toast"),o(),h(11,wo,5,0,"div",2)),e&2&&(s(4),c("ngIf",!r.loading),s(5),L(E(4,po)),s(2),c("ngIf",r.loading))},dependencies:[dt,z,q,U,Z,B,Le,Ie,Q,Ce,W,N,A,ce,$,me,V,D,Me,k,K,P,Ye,it]});let a=d;return a})();var al=[{path:"compra/lote/index",component:ot},{path:"venta/lote/index",component:ot}];export{al as ComercializacionRoutes};
